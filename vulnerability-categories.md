# vulnerability-categories

Vulnerabilies' features grouped by vulnerabilities' categories.

- Cross-Site Scripting (XSS)
  - Reflected Cross-Site Scripting (Reflected XSS)
  - Stored Cross-Site Scripting (Stored XSS)
  - DOM Cross-Site Scripting (DOM XSS)
- Insecure Direct Object Reference (IDOR)
- Business Logic Flaw
- Brute Force
- Simple Remote Code Execution (Simple RCE)
- Clickjacking
- Open Redirection
- Local File Inclusion (LFI)
- Remode File Incusion (RFI)
- Server Side Request Forgery (SSRF)
- HTTP Header Injection
- Cross-Site Request Forgery (CSRF)
- Cross-Site Script Inclusion (XSSI)
- XML External Enity (XXE)
- Subdomain Takeover
- SQL Injection (SQLI)
- Complicated Remote Code Execution (Complicated RCE)

### Cross-Site Scripting (XSS)

- [Blind XSS for beginners](https://medium.com/bugbountywriteup/blind-xss-for-beginners-c88e48083071) by Syntax Error
  - How to register in XSShunter (`https://xsshunter.com/`), where to spray the payload.
- [XSS Polyglot Challenge](https://polyglot.innerht.ml/) by ?
  - Because of polyglot, payloads listed in this here are very useful to hunt blind XSS.
- [Stored, Reflected and DOM XSS in Google for Work Connect (GWC)](http://respectxss.blogspot.com/2016/02/stored-reflected-and-dom-xss-in-google.html) by Ashar Javed
  - Stored XSS - title of the post entered by user was encoded properly, but not the one created by the Google Drive file.
  - Reflected XSS - an error message in a GET parameter.
  - DOM XSS - Javascript code executes only if someone marked/clicked the reply of a posting "Mark as Helpful".
 - [XSS in Google Colaboratory + CSP bypass](https://blog.bentkowski.info/2018/06/xss-in-google-colaboratory-csp-bypass.html) by Michał Bentkowski
  - Most markdown parsers allow you to use HTML syntax directly.
  - A very common way to inject JS code in markdown parsers is to use hyperlinks with `javascript:` protocol. For example, the code: `[CLICK](javascript:alert(1))`.
  - Find the frameworks used behind the scene, and read the documents of the products.
  - [This presentation](https://www.blackhat.com/docs/us-17/thursday/us-17-Lekies-Dont-Trust-The-DOM-Bypassing-XSS-Mitigations-Via-Script-Gadgets.pdf) showed that you can use a lot of popular JS framework to bypass various mitigations aganist XSS-es, including CSP. In the presentation you can also find a slide which shows what kind of security measure you can bypass with a given framework.
  - Rewriting the something already existed is a good idea.
- [Another XSS in Google Colaboratory](https://blog.bentkowski.info/2018/09/another-xss-in-google-colaboratory.html) by  Michał Bentkowski
  - Keep thinking, a tiny difference maybe matters.
  - This writeup showed how to bypassing the previous fixed.
- [Uber Bug Bounty: Turning Self-XSS into Good-XSS](https://whitton.io/articles/uber-turning-self-xss-into-good-xss/) by Jack Whitton
  - Payload (`1<script>alert(document.domain);</script>`) in drivers' profile on Uber's Partners protal was triggered, but this was a self-XSS.
  - OAuth login flow without `state` parameter introduced a  CSRF vulnerability in the login function, there is a CSRF vulnerability in the logout function too.
  - Since our payload is only available inside our account, we want to log the user into our account, which in turn will execute the payload. However, logging them into our account destroys their session, which destroys a lot of the value of the bug (it's no longer possible to perform action on their account).
  - Chaining minor bugs: First, log the user out of their `partner.uber.com` session, but not their `login.uber.com` session, this ensures that we can log them back into their account. Second, log the user into our account, so that our payload will be executed. Finally, log them back into their account (this must be in an iframe), whilst our code is still running, so that we can access their details (create another iframe to grab some of their data).
  - Using "Content Security Policy" to define which sources are allowed to be loaded could stop browser following 302 redirection (If this works, CSP violation error message will show in "Console" in Chrome debug tool).
  - The payload in this writeup is worth to study.
- [AirBnb Bug Bounty: Turning Self-XSS in Ture-Client-IP Header into Good-XSS #2](http://www.geekboy.ninja/blog/airbnb-bug-bounty-turning-self-xss-into-good-xss-2/) by geekboy
  - Instead of normal XSS Payload, injected remote hosted JS.
  - Victim to login into attacker's account via CSRF.
  - Attacker's remote hosted JS will get executed.
  - JS will perform 5 actions in iframe which are as follows:
    - Victim will get logged out from attacker's account.
    - Victim will get logged into his account via "Google Signin".
    - Attacker will navigate to "Profile Setting" page.
    - Attacker will extract the CSRF token from source code.
    - Attacker will update the victim email.
- [Turning Self-XSS into Good XSS in Uber v2: Chanllenge Completed but Not Rewarded](https://httpsonly.blogspot.hk/2016/08/turning-self-xss-into-good-xss-v2.html) by httpsonly
  - User can be authenticated on `m.uber.com` by only presenting COOKIE `token`. Hence, if it is somehow possible to login victim user into our account with self-XSS, it is possible to steal `oauth2` cookie of a real user and perform any other malicious actions (since it is scoped to `subdomain.uber.com`).
  - Arbitrary cookie install vulnerabilty was found on page `https://business.uber.com/new/confirm/[exploit-here]`, band is based on the fact that user input comes into server's response, directly into Cookie header and is not properly sanitized. Hence, it was possible to install various cookie for any `subdomain.uber.com`. Payload: `https://business.uber.com/new/confirm/test;,arbitrary=cookie;domain=.uber.com`.

#### Reflected Cross-Site Scripting (Reflected XSS)

- [Managed Apps and Music: a tale of two XSSes in Google Play](https://ysx.me.uk/managed-apps-and-music-a-tale-of-two-xsses-in-google-play/) by Yasin Soliman
  - This blog listed some google resources that are very useful for google bug hunters.
  - Payload `https://play.google.com/schools/termsofservice?continue=javascript:confirm(document.domain)` (two limitions for exploitaiton).
  - Payload `https://play.google.com/music/listen?u=0#/sr/'"><img src=x onerror=confirm(document.domain)>` (straightforward, actually this was a stored XSS).
- [Filter Bypass to Reflected XSS on https://finance.yahoo.com (mobile version)](https://medium.com/@saamux/filter-bypass-to-reflected-xss-on-https-finance-yahoo-com-mobile-version-22b854327b27) by Samuel
  - In the hunting process, the author detected some websites that are responsive in a mobile way. The author tried to find any bugs on the website `https://finance.yahoo.com`, but he didn't find anything, so he decided to find bugs in the mobile version of this website.
  - Payload `https://finance.yahoo.com/quote/"></script><svg onload=alert(1)>` was processed in capital letters, and `alert` in capital letters does not work. This could be bypassed using `&#97;&#108;&#101;&#114;&#116;` ("alert" HTML character encoding).
  - Final payload `https://finance.yahoo.com/quote/"></script><svg onload=%26%2397%3B%26%23108%3B%26%23101%3B%26%23114%3B%26%23116%3B(document.domain)>`.
- [DOM XSS - auth.uber.com](http://web.archive.org/web/20180331193745/http://stamone-bug-bounty.blogspot.com/2017/10/dom-xss-auth_14.html) by StamOne
  - There is no redirect using location header and the response code is 200 but the author still got redirected, which can mean only one thing, the redirect performed using javascript in the browser. Usually it means something like this: `window.location.href = nextURL;`. In theory if someone can control the `nextURL` parameter, he can perform XSS: `window.location.href = javascript:alert(1);//` or `window.location.href = data:text/html;HTML_CODE`.
  - By removing the "Content Security Policy" header from the response, we could check if the alert box not popping because of CSP. Or we could check CSP violation error message in "Console" in Chrome debug tool.
  - I don't understand this writeup, but the previous two tips are useful.
- [How I XSS’ed Uber and Bypassed CSP](https://medium.com/@efkan162/how-i-xssed-uber-and-bypassed-csp-9ae52404f4c5) by Efkan
  - Using Google dork to find a invite URL contains three parameters, parameter `v` was not sanitized.
  - Code after injecting payload: `content="static/images/milestones/anniversary/anniversary_1"><img src=x onerror=alert(document.cookie)>.png"/>`. As you can see, there was no filtering but in the meantime there was no XSS pop-up, blocked by "Content Security Policy" (We could confirm this by removing the CSP header from the response or checking CSP violation error message in "Console" in Chrome debug tool).
  - "script-src" in CSP header includes `subdomain.uber.com`, if we could find any JSON endpoint with callback or anything similar, then we are able to execute XSS (why? see flowing payload).
  - Payload: `https://partners.uber.com/p3/referrals/ms?i=bq6ew1w9ue&m=ANNIVERSARY&v=1"><script src=”https://mkto.uber.com/index.php/form/getKnownLead?callback=alert(document.domain);"></script>`.
  - The author was inspired by [this writeup](http://web.archive.org/web/20180331193745/http://stamone-bug-bounty.blogspot.com/2017/10/dom-xss-auth_14.html) to come up with the endpoint to bypass CSP.
- [Making an XSS triggered by CSP bypass on Twitter](https://medium.com/@tbmnull/making-an-xss-triggered-by-csp-bypass-on-twitter-561f107be3e5) by tbmnull
  - The author used whitelist vulnerable URL to bypass CSP.
  - Payload: `https://careers.twitter.com/en/jobs-search.html?location=1"><script src=//analytics.twitter.com/tpm?tpm_cb=alert(document.domain)>//`.

#### Stored Cross-Site Scripting (Stored XSS)

- [A Few of My Favorite Facebook Stored XSS Findings](http://www.breaksec.com/?p=6129) by Nirgoldshlager
  - Three old but interesting and critical Facebook strored XSSes which the author happened to find them in the right location.
- [XSS on Facebook-Instagram CDN Server bypassing signature protection](https://www.amolbaikar.com/xss-on-facebook-instagram-cdn-server-bypassing-signature-protection/) by Amol Baikar
- [XSS on Facebook’s acquisition Oculus CDN](https://www.amolbaikar.com/xss-on-facebooks-acquisition-oculus-cdn/) by Amol Baikar
  - Bypassing signature protection on Facebook's CDN server, uploading `.jpg` pictures containing malicious payload, accessing the `.jpg` by changing extion to `.html`.
- [Stored XSS in Google Drive (Folder Name)](https://pwnrules.com/google-drive-stored-xss/) by Ibrahim Raafat
  - An old blog, creating a folder with malicious payload name, searching about any place which need writing the folder name in the page.
- [Sleeping stored Google XSS Awakens a $5000 Bounty](https://blog.it-securityguard.com/bugbounty-sleeping-stored-google-xss-awakens-a-5000-bounty/) by Patrik Fehrenbach
  - Payload (`"><img src=x onerror=javascript: alert(1);`) in project title was fired when delete the project.
  - This was not classified as a low level self XSS, because the Google Cloud Platform can be used by multiple users, if a user creates a project with a malicious XSS payload, that payload could be used against the project administrator to execute malicious javascript (if they delete the project).
- [Google adwords 3133.7$ Stored XSS](https://medium.com/@Alra3ees/google-adwords-3133-7-stored-xss-27bb083b8d27) by Emad Shanab
  - The author is a full time lawyer, in the writeup he shared how he choose his target.
  - Malicious payload (`"><svg/onload=alert(document.domain)>"@x.y`) in the conversation name was triggered.
- [Stored XSS, and SSRF in Google using the Dataset Publishing Language](https://s1gnalcha0s.github.io/dspl/2018/03/07/Stored-XSS-and-SSRF-Google.html) by Signal Chaos
  - The feature (parase user upload XML and also allow data to be retrieved from remote HTTP or FTP sources) of this product seems vulnerable.
  - Readers could learn how to write a similar proc in XML.
- [Google Assistant XSS Bug Worth $3133.7](https://medium.com/bug-bounty-hunting/google-assistant-bug-worth-3133-7-830a03724a04) by Circle Ninja
  - The author classify this as a reflected XSS, but I thought this is a stored XSS.
  - Saving some payloads on each field, no tags (< > etc.) were filtered, but the XSS never popped (why? I thought the author maybe miss something.)
  - using data uri and base64 enconding to create XSS (`"><a href="data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik8L3NjcmlwdD4=”>click</a>"`).
- [XSSing Google Code-in thanks to improperly escaped JSON data](https://blog.thomasorlita.cz/vulns/google-code-in-xss/) by Thomas Orlita
  - Signing up Google Code-in and puting payload into all the text fields, when the author clicked the submit button, all the payloads were executed, and the payloads continued executing on every page the author visited. This alone didn't mean much as it would only classify as an Self-XSS, but meant that this didn't have to be the only place it was unescaped.
  - Payload (`"'><script src=x></script>{{1-1}}`) in the comments of tasks was fired.
- [Yahoo Mail stored XSS](https://klikki.fi/adv/yahoo.html) by Jouko Pynnönen
  - As most email solutions these days, Yahoo Mail dispalys HTML-formatted email messages after filtering any potentially malicious code. But certain malformed HTML code could pass the filter.
  - A message containing all known HTML tags and attributes was created to see which of them the Yahoo filter lets through. After viewing the resulting email, the author noticed that if certain, supposedly "boolean" HTM attributes were given a value, the value was removed by the filter, but the equals sign was not.
  - Example: `<INPUT TYPE="checkbox" CHECKED="hello" NAME="check box">` became `<INPUT TYPE="checkbox" CHECKED= NAME="check box">`
  - [HTML specification](https://www.w3.org/TR/html/syntax.html) alows "zero or more space characters" a round the equals sign in an unquoted attribute value.
  - Proc: `<img ismap='xxx' itemtype='yyy style=width:100%;height:100%;position:fixed;left:0px;top:0px; onmouseover=alert(/XSS/)//'>` became `<img ismap=itemtype=yyy style=width:100%;height:100%;position:fixed;left:0px;top:0px; onmouseover=alert(/XSS/)>` (some of the quote symbols edited for clarity).
  - The browser would render an IMG tag filling the entire window. The JavaScritpt code in the `onmouseover` attribute would be immediately executed, without further user interaction. Blocking or allowing images in mail setting didn't affecting this behavior (why?).
- [Yahoo Mail stored XSS #2](https://klikki.fi/adv/yahoo2.html) by Jouko Pynnönen
  - Composing an email containing different kind of attachments and sent it to an external mailbox, this way the author could inspect the "raw" HTML this kind of email contained.
  - "Share files from cloud providers" option won't create a traditional email attachment but inserts a HTML link to Google Docs or Dropbox along with some decorative HTML.
  - `data-*` HTML attributes are used to store application-specific data typically for Javascript use.
  - To get a more complete picture of the available `data-*` attributes, the author went to the source tab in Chrome's Developer Tools and looked for references to `data-url` in the JavaScript files that are loaded in the mail reading view.
  - Creating an email with abusive `data-*` attributes:
```
<div class="yahoo-link-enhancr-card" data-url="https://www.youtube.com/aaa&quot;&gt;&lt;img src=x onerror=alert(/xss/)&gt;&lt;">
<div class="card-share-container">
<a class="enhancr-play-btn"></a>
</div></div>
```
- [Stored XSS affecting all fantasy sports - subdomain.fantasysports.yahoo.com](https://web.archive.org/web/20161228182923/http://dawgyg.com/2016/12/07/stored-xss-affecting-all-fantasy-sports-fantasysports-yahoo-com-2/) by thedawgyg
  - Payload in "Message Board -> Post New Topic -> Title" was triggered.
  - Payload `<img src="x:? title=" onerror=alert(document.domain)//">` became `<img src="x:? title=" title="" onerror=alert(document.domain)//">`.
- [Stored XSS in Yahoo!](https://medium.com/@TheShahzada/stored-xss-in-yahoo-b0878ecc97e2) by Shahzada AL Shahriar Khan
  - Payload `&quot;&gt;&lt;img src=x onerror=confirm(1);&gt;` in comments of Yahoo! News triggered.

#### DOM Cross-Site Scripting (DOM XSS)

### Insecure Direct Object Reference (IDOR)

### Business Logic Flaw

### Brute Force

### Simple Remote Code Execution (Simple RCE)

### Clickjacking

### Open Redirection

- [Use Two Open Redirects to Trigger an XSS in Google website - Open redirects that matter](https://sites.google.com/site/bughunteruniversity/best-reports/openredirectsthatmatter) by Tomasz Bojarski
  - This is a complicated writeup writen by Google security engineer, with detailed techques analyzing.
  - The writer started with the report, analyzing how the proc finally was triggered. The reader could even read the source code of the website.
  - To bypass the prefix check, using `https://picasaweb.google.com/data/feed/api/../../../bye`.
  - To bypass the prevention of MIME sniffing vulnerabilities, triggering an error. The error message should contain HTML code.
  - Open redirects are super useful in bug chains, especially when used to bypass a prefix-based URL whitelist.
  - It's also useful to set up your own server to respond with various invalid header valuse, as not everything can be tested using a tampering proxy alone.
- [dev.twitter.com - Open Redirect and XSS](https://blog.blackfan.ru/2017/09/devtwittercom-xss.html) [hackerone report](https://hackerone.com/reports/260744) by Sergey Bobrov
  - Twitter XSS by stopping redirection and Javascript scheme. A table showed the way the author walked through.
  - Having created a link with an incorrect port in the "Location header", the author managed to block the redirection in FireFox browser.

### Local File Inclusion (LFI)

### Remode File Incusion (RFI)

### Server Side Request Forgery (SSRF)

### HTTP Header Injection

### Cross-Site Request Forgery (CSRF)

### Cross-Site Script Inclusion (XSSI)

### XML External Enity (XXE)

### Subdomain Takeover

### SQL Injection (SQLI)

### Complicated Remote Code Execution (Complicated RCE)
