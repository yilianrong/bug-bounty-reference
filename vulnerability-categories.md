# vulnerability-categories

Vulnerabilies' features grouped by vulnerabilities' categories.

- Cross-Site Scripting (XSS)
  - Reflected Cross-Site Scripting (Reflected XSS)
  - Stored Cross-Site Scripting (Stored XSS)
- Insecure Direct Object Reference (IDOR)
- Cross-Site Request Forgery (CSRF)
- Sensitive Information Exposure
- Business Logic Flaw
- Brute Force
- Clickjacking
- Open Redirection
- Server Side Request Forgery (SSRF)
- File Inclusion (LFI)
  - Local File Inclusion (LFI)
  - Remode File Incusion (RFI)
- Simple Remote Code Execution (Simple RCE)
- HTTP Header Injection
- Subdomain Takeover

### Cross-Site Scripting (XSS)

- [Blind XSS for beginners](https://medium.com/bugbountywriteup/blind-xss-for-beginners-c88e48083071) by Syntax Error
  - How to register in XSShunter (`https://xsshunter.com/`), where to spray the payload.
- [XSS Polyglot Challenge](https://polyglot.innerht.ml/) by ?
  - Because of polyglot, payloads listed in this here are very useful to hunt blind XSS.
- [Stored, Reflected and DOM XSS in Google for Work Connect (GWC)](http://respectxss.blogspot.com/2016/02/stored-reflected-and-dom-xss-in-google.html) by Ashar Javed
  - Stored XSS - title of the post entered by user was encoded properly, but not the one created by the Google Drive file.
  - Reflected XSS - an error message in a GET parameter.
  - DOM XSS - Javascript code executes only if someone marked/clicked the reply of a posting "Mark as Helpful".
- [XSS in Google Colaboratory + CSP bypass](https://blog.bentkowski.info/2018/06/xss-in-google-colaboratory-csp-bypass.html) by Michał Bentkowski
  - Most markdown parsers allow you to use HTML syntax directly.
  - A very common way to inject JS code in markdown parsers is to use hyperlinks with `javascript:` protocol. For example, the code: `[CLICK](javascript:alert(1))`.
  - Find the frameworks used behind the scene, and read the documents of the products.
  - [This presentation](https://www.blackhat.com/docs/us-17/thursday/us-17-Lekies-Dont-Trust-The-DOM-Bypassing-XSS-Mitigations-Via-Script-Gadgets.pdf) showed that you can use a lot of popular JS framework to bypass various mitigations aganist XSS-es, including CSP. In the presentation you can also find a slide which shows what kind of security measure you can bypass with a given framework.
  - Rewriting the something already existed is a good idea.
- [Another XSS in Google Colaboratory](https://blog.bentkowski.info/2018/09/another-xss-in-google-colaboratory.html) by  Michał Bentkowski
  - Keep thinking, a tiny difference maybe matters.
  - This writeup showed how to bypassing the previous fixed.
- [Uber Bug Bounty: Turning Self-XSS into Good-XSS](https://whitton.io/articles/uber-turning-self-xss-into-good-xss/) by Jack Whitton
  - Payload (`1<script>alert(document.domain);</script>`) in drivers' profile on Uber's Partners protal was triggered, but this was a self-XSS.
  - OAuth login flow without `state` parameter introduced a  CSRF vulnerability in the login function, there is a CSRF vulnerability in the logout function too.
  - Since our payload is only available inside our account, we want to log the user into our account, which in turn will execute the payload. However, logging them into our account destroys their session, which destroys a lot of the value of the bug (it's no longer possible to perform action on their account).
  - Chaining minor bugs: First, log the user out of their `partner.uber.com` session, but not their `login.uber.com` session, this ensures that we can log them back into their account. Second, log the user into our account, so that our payload will be executed. Finally, log them back into their account (this must be in an iframe), whilst our code is still running, so that we can access their details (create another iframe to grab some of their data).
  - Using "Content Security Policy" to define which sources are allowed to be loaded could stop browser following 302 redirection (If this works, CSP violation error message will show in "Console" in Chrome debug tool).
  - The payload in this writeup is worth to study.
- [AirBnb Bug Bounty: Turning Self-XSS in Ture-Client-IP Header into Good-XSS #2](http://www.geekboy.ninja/blog/airbnb-bug-bounty-turning-self-xss-into-good-xss-2/) by geekboy
  - Instead of normal XSS Payload, injected remote hosted JS.
  - Victim to login into attacker's account via CSRF.
  - Attacker's remote hosted JS will get executed.
  - JS will perform 5 actions in iframe which are as follows:
    - Victim will get logged out from attacker's account.
    - Victim will get logged into his account via "Google Signin".
    - Attacker will navigate to "Profile Setting" page.
    - Attacker will extract the CSRF token from source code.
    - Attacker will update the victim email.
- [Turning Self-XSS into Good XSS in Uber v2: Chanllenge Completed but Not Rewarded](https://httpsonly.blogspot.hk/2016/08/turning-self-xss-into-good-xss-v2.html) by httpsonly
  - User can be authenticated on `m.uber.com` by only presenting COOKIE `token`. Hence, if it is somehow possible to login victim user into our account with self-XSS, it is possible to steal `oauth2` cookie of a real user and perform any other malicious actions (since it is scoped to `subdomain.uber.com`).
  - Arbitrary cookie install vulnerabilty was found on page `https://business.uber.com/new/confirm/[exploit-here]`, band is based on the fact that user input comes into server's response, directly into Cookie header and is not properly sanitized. Hence, it was possible to install various cookie for any `subdomain.uber.com`. Payload: `https://business.uber.com/new/confirm/test;,arbitrary=cookie;domain=.uber.com`.
- [Self-XSS + CSRF to Stored XSS](https://medium.com/@renwa/self-xss-csrf-to-stored-xss-54f9f423a7f1) by Renwa
  - The author found a XSS by changing his name to a milicious payload (`"><svg onload=alert(document.domain)>`) in the profile page. This is a self-XSS.
  - But "change profile action" wasn't protected by CSRF, so the we can execute our payload against other users by changing their profile. This is also a blind XSS, the author used XSShunter.
  - This maybe the easiest way to turn self-XSS into strored XSS.
- [ACCOUNT TAKEOVER AND BLIND XSS! GO PRO, GET BUGS!](https://blog.witcoat.com/2018/05/30/account-takeover-and-blind-xss-go-pro-get-bugs/) by Tabahi
  - An IDOR allowed attacker to create an `element x` in every user's account, the text field of `element x` was also velnerable to stored XSS, payload `'%22%3E%3Cimg+src%3Dx+onerror%3Dalert(document.cookie)%3E`.
  - Attacker could store XSS in every user's account through the IDOR. There was no CSP blocking external scripts, so attacker could just write a small script which would steal a victim's CSRF token and then change their emailID or invite the attacker as an Admin, taking over their account.
  - The proc in this writeup is worth to study, and also try to maximize the severity.
  - An invoice was generated using some fiels supplied by the user at the time of billing. Inject some html elements and also put some blind XSS payload. The author used XSShunter and a blind XSS payload had triggered on the program's Admin Panel.

#### Reflected Cross-Site Scripting (Reflected XSS)

- [Managed Apps and Music: a tale of two XSSes in Google Play](https://ysx.me.uk/managed-apps-and-music-a-tale-of-two-xsses-in-google-play/) by Yasin Soliman
  - This blog listed some google resources that are very useful for google bug hunters.
  - Payload `https://play.google.com/schools/termsofservice?continue=javascript:confirm(document.domain)` (two limitions for exploitaiton).
  - Payload `https://play.google.com/music/listen?u=0#/sr/'"><img src=x onerror=confirm(document.domain)>` (straightforward, actually this was a stored XSS).
- [Filter Bypass to Reflected XSS on https://finance.yahoo.com (mobile version)](https://medium.com/@saamux/filter-bypass-to-reflected-xss-on-https-finance-yahoo-com-mobile-version-22b854327b27) by Samuel
  - In the hunting process, the author detected some websites that are responsive in a mobile way. The author tried to find any bugs on the website `https://finance.yahoo.com`, but he didn't find anything, so he decided to find bugs in the mobile version of this website.
  - Payload `https://finance.yahoo.com/quote/"></script><svg onload=alert(1)>` was processed in capital letters, and `alert` in capital letters does not work. This could be bypassed using `&#97;&#108;&#101;&#114;&#116;` ("alert" HTML character encoding).
  - Final payload `https://finance.yahoo.com/quote/"></script><svg onload=%26%2397%3B%26%23108%3B%26%23101%3B%26%23114%3B%26%23116%3B(document.domain)>`.
- [DOM XSS - auth.uber.com](http://web.archive.org/web/20180331193745/http://stamone-bug-bounty.blogspot.com/2017/10/dom-xss-auth_14.html) by StamOne
  - There is no redirect using location header and the response code is 200 but the author still got redirected, which can mean only one thing, the redirect performed using javascript in the browser. Usually it means something like this: `window.location.href = nextURL;`. In theory if someone can control the `nextURL` parameter, he can perform XSS: `window.location.href = javascript:alert(1);//` or `window.location.href = data:text/html;HTML_CODE`.
  - By removing the "Content Security Policy" header from the response, we could check if the alert box not popping because of CSP. Or we could check CSP violation error message in "Console" in Chrome debug tool.
  - I don't understand this writeup, but the previous two tips are useful.
- [How I XSS’ed Uber and Bypassed CSP](https://medium.com/@efkan162/how-i-xssed-uber-and-bypassed-csp-9ae52404f4c5) by Efkan
  - Using Google dork to find a invite URL contains three parameters, parameter `v` was not sanitized.
  - Code after injecting payload: `content="static/images/milestones/anniversary/anniversary_1"><img src=x onerror=alert(document.cookie)>.png"/>`. As you can see, there was no filtering but in the meantime there was no XSS pop-up, blocked by "Content Security Policy" (We could confirm this by removing the CSP header from the response or checking CSP violation error message in "Console" in Chrome debug tool).
  - "script-src" in CSP header includes `subdomain.uber.com`, if we could find any JSON endpoint with callback or anything similar, then we are able to execute XSS (why? see flowing payload).
  - Payload: `https://partners.uber.com/p3/referrals/ms?i=bq6ew1w9ue&m=ANNIVERSARY&v=1"><script src=”https://mkto.uber.com/index.php/form/getKnownLead?callback=alert(document.domain);"></script>`.
  - The author was inspired by [this writeup](http://web.archive.org/web/20180331193745/http://stamone-bug-bounty.blogspot.com/2017/10/dom-xss-auth_14.html) to come up with the endpoint to bypass CSP.
- [Making an XSS triggered by CSP bypass on Twitter](https://medium.com/@tbmnull/making-an-xss-triggered-by-csp-bypass-on-twitter-561f107be3e5) by tbmnull
  - The author used whitelist vulnerable URL to bypass CSP.
  - Payload: `https://careers.twitter.com/en/jobs-search.html?location=1"><script src=//analytics.twitter.com/tpm?tpm_cb=alert(document.domain)>//`.
- [XSS on Bugcrowd and so many other website's main Domain](http://witcoat.blogspot.com/2017/06/xss-on-bugcrowd-and-so-many-other.html) by Bull
  - `local` parameter in the 404 page URL of Bugcrow is vulnerable to XSS (payload: `<svg/onload=alert(1)>`), also in the homepage URL (`https://bugcrowd.com?locale=xss`).
  - This was a vulnerability in Locomotive CMS, so it affected many other website which used Locomotive CMS.
- [Story of Parameter Specific XSS](https://www.noob.ninja/2017/09/story-of-parameter-specific-xss.html) by Noob Ninja
  - URL: `https://www.private-bounty.com/Deactivate?view=aaa&utm_content=foo&utm_medium=bar&utm_source=baz` was reflected in the page in Javascript context as: `https://www.private-bounty.com/Deactivate?utm_content=foo&utm_medium=bar&utm_source=baz`, but the values of the parameters were properly encoded.
  - The author found the pattern of `utm_content=foo&utm_medium=bar&utm_source=baz` on every endpoint getting reflected and no other parameter will be reflected. The author tried to append a random custom parameter to see if it gets reflected, but it didn't work.
  - Following the original pattern, the author appended parameter with `utm_` prefix, this parameter was not being encoded when reflected in the page. Payload: `https://www.private-bounty.com/Deactivate?utm_content=foo&utm_medium=bar&utm_source=baz&utm_foobarbaz');alert(1)//`.
  - This writeup show us a way to find hinden parameter in URL.
- [DOM based XSS - or why you should not rely on Cloudflare too much](https://medium.com/bugbountywriteup/dom-based-xss-or-why-you-should-not-rely-on-cloudflare-too-much-a1aa9f0ead7d) by KatsuragiCSL
  - The author registered an account using email *a@a.com* without verifying it and tried to sighup with the same email again. Then an error message is popped up and the vaule of the `Message` parameter in URL is reflected in error message.
  - Just set the vaule of the `Message` parameter to `<script>alert(1)</script>`, the URL was blocked by Cloudflare.
  - The the content of the `Message` parameter is inserted in javascript directly ("view page source"), so payload: `alert("something_here");evil_script_here// ")`.
  - Good firewalls can't save bad code.
- [Two XSSed in ucweb.com ( Alibaba’s Bug Bounty Programme) - Story about my first bug bounty](https://medium.com/@sudhanshur705/story-about-my-first-bug-bounty-9fe710be8241) by Sudhanshu Raj
  - The author checked the available subdomains by using `https://virustotal.com` and started going through them one by one.
  - Just random picked `samsung.ucweb.com` and got "403 Forbidden". If you encounter any page like this google the site you may find an endpoint which is accessible.
  - `title` in `http://samsung.ucweb.com/webstore/classify.html?dataKey=LifeStyle&title=LifeStyle` (found by using google dork: `site:samsung.ucweb.com`) was not filtered, malicious payload `<img src=x onerror=alert(‘XSS’)>` was triggerred.
  - The company fixed the previous XSS by removing that endpoint and if the author tried to open that endpoint he got a "404 error not found".
  - Used dirsearch to search new endpoints and found `http://samsung.ucweb.com/test/`, in this page the author found a same url just like before: `http://samsung.ucweb.com/test/classify.html?dataKey=New&title=`, also same payload worked.

#### Stored Cross-Site Scripting (Stored XSS)

- [A Few of My Favorite Facebook Stored XSS Findings](http://www.breaksec.com/?p=6129) by Nirgoldshlager
  - Three old but interesting and critical Facebook strored XSSes which the author happened to find them in the right location.
- [XSS on Facebook-Instagram CDN Server bypassing signature protection](https://www.amolbaikar.com/xss-on-facebook-instagram-cdn-server-bypassing-signature-protection/) by Amol Baikar
- [XSS on Facebook’s acquisition Oculus CDN](https://www.amolbaikar.com/xss-on-facebooks-acquisition-oculus-cdn/) by Amol Baikar
  - Bypassing signature protection on Facebook's CDN server, uploading `.jpg` pictures containing malicious payload, accessing the `.jpg` by changing extion to `.html`.
- [Stored XSS in Google Drive (Folder Name)](https://pwnrules.com/google-drive-stored-xss/) by Ibrahim Raafat
  - An old blog, creating a folder with malicious payload name, searching about any place which need writing the folder name in the page.
- [Sleeping stored Google XSS Awakens a $5000 Bounty](https://blog.it-securityguard.com/bugbounty-sleeping-stored-google-xss-awakens-a-5000-bounty/) by Patrik Fehrenbach
  - Payload (`"><img src=x onerror=javascript: alert(1);`) in project title was fired when delete the project.
  - This was not classified as a low level self XSS, because the Google Cloud Platform can be used by multiple users, if a user creates a project with a malicious XSS payload, that payload could be used against the project administrator to execute malicious javascript (if they delete the project).
- [Google adwords 3133.7$ Stored XSS](https://medium.com/@Alra3ees/google-adwords-3133-7-stored-xss-27bb083b8d27) by Emad Shanab
  - The author is a full time lawyer, in the writeup he shared how he choose his target.
  - Malicious payload (`"><svg/onload=alert(document.domain)>"@x.y`) in the conversation name was triggered.
- [Stored XSS, and SSRF in Google using the Dataset Publishing Language](https://s1gnalcha0s.github.io/dspl/2018/03/07/Stored-XSS-and-SSRF-Google.html) by Signal Chaos
  - The feature (parase user upload XML and also allow data to be retrieved from remote HTTP or FTP sources) of this product seems vulnerable.
  - Readers could learn how to write a similar proc in XML.
- [Google Assistant XSS Bug Worth $3133.7](https://medium.com/bug-bounty-hunting/google-assistant-bug-worth-3133-7-830a03724a04) by Circle Ninja
  - The author classify this as a reflected XSS, but I thought this is a stored XSS.
  - Saving some payloads on each field, no tags (< > etc.) were filtered, but the XSS never popped (why? I thought the author maybe miss something.)
  - using data uri and base64 enconding to create XSS (`"><a href="data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik8L3NjcmlwdD4=”>click</a>"`).
- [XSSing Google Code-in thanks to improperly escaped JSON data](https://blog.thomasorlita.cz/vulns/google-code-in-xss/) by Thomas Orlita
  - Signing up Google Code-in and puting payload into all the text fields, when the author clicked the submit button, all the payloads were executed, and the payloads continued executing on every page the author visited. This alone didn't mean much as it would only classify as an Self-XSS, but meant that this didn't have to be the only place it was unescaped.
  - Payload (`"'><script src=x></script>{{1-1}}`) in the comments of tasks was fired.
- [Yahoo Mail stored XSS](https://klikki.fi/adv/yahoo.html) by Jouko Pynnönen
  - As most email solutions these days, Yahoo Mail dispalys HTML-formatted email messages after filtering any potentially malicious code. But certain malformed HTML code could pass the filter.
  - A message containing all known HTML tags and attributes was created to see which of them the Yahoo filter lets through. After viewing the resulting email, the author noticed that if certain, supposedly "boolean" HTM attributes were given a value, the value was removed by the filter, but the equals sign was not.
  - Example: `<INPUT TYPE="checkbox" CHECKED="hello" NAME="check box">` became `<INPUT TYPE="checkbox" CHECKED= NAME="check box">`
  - [HTML specification](https://www.w3.org/TR/html/syntax.html) alows "zero or more space characters" a round the equals sign in an unquoted attribute value.
  - Proc: `<img ismap='xxx' itemtype='yyy style=width:100%;height:100%;position:fixed;left:0px;top:0px; onmouseover=alert(/XSS/)//'>` became `<img ismap=itemtype=yyy style=width:100%;height:100%;position:fixed;left:0px;top:0px; onmouseover=alert(/XSS/)>` (some of the quote symbols edited for clarity).
  - The browser would render an IMG tag filling the entire window. The JavaScritpt code in the `onmouseover` attribute would be immediately executed, without further user interaction. Blocking or allowing images in mail setting didn't affecting this behavior (why?).
- [Yahoo Mail stored XSS #2](https://klikki.fi/adv/yahoo2.html) by Jouko Pynnönen
  - Composing an email containing different kind of attachments and sent it to an external mailbox, this way the author could inspect the "raw" HTML this kind of email contained.
  - "Share files from cloud providers" option won't create a traditional email attachment but inserts a HTML link to Google Docs or Dropbox along with some decorative HTML.
  - `data-*` HTML attributes are used to store application-specific data typically for Javascript use.
  - To get a more complete picture of the available `data-*` attributes, the author went to the source tab in Chrome's Developer Tools and looked for references to `data-url` in the JavaScript files that are loaded in the mail reading view.
  - Creating an email with abusive `data-*` attributes:
```
<div class="yahoo-link-enhancr-card" data-url="https://www.youtube.com/aaa&quot;&gt;&lt;img src=x onerror=alert(/xss/)&gt;&lt;">
<div class="card-share-container">
<a class="enhancr-play-btn"></a>
</div></div>
```
- [Stored XSS affecting all fantasy sports - subdomain.fantasysports.yahoo.com](https://web.archive.org/web/20161228182923/http://dawgyg.com/2016/12/07/stored-xss-affecting-all-fantasy-sports-fantasysports-yahoo-com-2/) by thedawgyg
  - Payload in "Message Board -> Post New Topic -> Title" was triggered.
  - Payload `<img src="x:? title=" onerror=alert(document.domain)//">` became `<img src="x:? title=" title="" onerror=alert(document.domain)//">`.
- [Stored XSS in Yahoo!](https://medium.com/@TheShahzada/stored-xss-in-yahoo-b0878ecc97e2) by Shahzada AL Shahriar Khan
  - Payload `&quot;&gt;&lt;img src=x onerror=confirm(1);&gt;` in comments of Yahoo! News triggered.
- [Stored XSS on Snapchat](https://medium.com/@mrityunjoy/stored-xss-on-snapchat-5d704131d8fd) by Mrityunjoy
  - This was a stored XSS on Snapchat Ads domain.
  - Create an ADS account with milicious payload (`test"><img src=x onerror=prompt<domain)>`) in "BUSINESS NAME" field.
  - Create an Organization and invite new members on the Organization via email address.
  - XSS POPUP on the invitation page rendered by the invitation link in the email.

### Insecure Direct Object Reference (IDOR)

- [How-To: Find IDOR (Insecure Direct Object Reference) Vulnerabilities for large bounty rewards](https://www.bugcrowd.com/how-to-find-idor-insecure-direct-object-reference-vulnerabilities-for-large-bounty-rewards/) by Sam Houston
  - It needs to understand the application flow developed by the software developers. All the modules functions and their sub-modules functions need to be understand when the logged-in user into the web / mobile application. Roles in the application must be well understood in order to identify IDOR vulnerability. If you know what that a role should do or should not do, it will be very useful during the phase of weakness detection.
  - It is also important to remember that this vulnerability is as severe as XSS, CSRF in security testing and as a type of vulnerability that is not easily descovered.
  - You can use the browser's secrete tab to quickly practically test IDOR vulnerabilities. So when you use the regular tab as a normal user, you can use the secret tab as an attacker. This will ensure that you don't logout.
  - You can use Burpsuite's "HTTP history" for checking all of requests. Also, you can use Burpsuite's "scope" feature for fast testing. Because the "scope" feature can be useful to make a "target" list and the "scope" feature allows showing only relevant data for your testing "scope". You can edit "scope" value and then filter the "HTTP history" by selecting "Show only in-scope items". 
- [Hacking Facebook.com/thanks Posting on behalf of your friends](http://www.anandpraka.sh/2014/11/hacking-facebookcomthanks-posting-on.html) by Anand Prakash
  - "Say Thanks" is an experience that lets Facebook user to create personalized video cards for their facebook friends. A user needs to visit `facebook.com/thanks` and have to choose a friend. Once you are ready you have to click on the "Share" button and your video will be shared on your timeline with the friend tagged. It will show up on your's as well as the friend's timeline.
  - Two exploitable surfaces:
    - Posting on the behalf of non-Facebook friend.
    - Posting on the behalf of a Facebook friend.
  - Positing on behalf of your Facebook friends worked. Used Burpsuite to capture the request, changed the `sender={"id":XXXXXX,` to victim's `Facebook ID`, in few seconds video got posted from the victim's Facebook profile.
- [How I could have removed all your Facebook notes](http://www.anandpraka.sh/2015/12/summary-this-blog-post-is-about.html) by Anand Prakash
  - "Facebook Notes" are ways of writing entries about your life, your thoughts, or your all-time favorite songs and then sharing them with your Facebook friends. When ou publish a Note, it appears in your "News Feed".
  - Attack could have removed all your notes just by replacing his `note_id` with yours in note editing request. `node_id` can be seen by visiting victim's note and copying the `id` from the URL.
  - This writeup tells us, if there are some `id` in the request, replace it with it's peers, maybe something unexpected will happen.
- [Overwriting/Removing Cover Photos on Facebook Event Pages](http://roy-castillo.blogspot.com/2016/02/overwritingremoving-cover-photos-on.html) by Roy Castillo
  - On "Facebook Events" pages, an attacker could have remove / overwrite your "Event Cover Photo" just by replacing his `event_id` with yours in Event editing request.
- [IDOR inf Facebook's Acquisition - Parse](http://www.pranav-venkat.com/2016/12/idor-in-facebooks-acquisition-parse.html) by Pranav Venkat
  - Parse is a backend as a service providing company which was acquired by Facebook in 2013. In other words, they provide you with an application development platform in the cloud.
  - Apps created in Parse have a feature to export the reports in csv format. Clicked "download option", a request containing `appname` was generated, changed the `appname` to other app's, you could download other app's reports.
- [Delete any video from Facebook](https://pranavhivarekar.in/2016/06/23/facebooks-bug-delete-any-video-from-facebook/) by PRANAV HIVAREKAR
  - "video comment" feature allowed users to upload a video in comments.
  - The author started playing around and testing this feature to find out how it works after it was out 8 hrs.
  - When we upload a video as a comment, then this video gets uploaded onto user / page 's timeline and then it gets attached to the post as a "video comment" using it's `video_id`. e.g. When any user comments using a video on any random post, then video will first get uploaded to the user's timeline and then `video_id` will be returned. This `video_id` gets attached to the post as a video comment.
  - Two simple flaws:
    - The author was able to attach anyone's "video" to his comment using it's `video_id`.
    - When the author deleted his "comment", then attached "video" got deleted. As it used only `video_id` and there were no permission checks placed to verify if the "user" owned the "video".
  - The author used `GraphAPI` to write a proc.
- [Delete Any Video on Facebook](https://danmelamed.blogspot.com/2017/01/facebook-vulnerability-delete-any-video.html) by Dan Melamed
  - This vulnerability is similar to the previous one, instead of attaching the victim's video to a comment, the author discovered a way to attach the video to an event post, when you delete an event post it also deletes the attached video.
  - The author could created an event post by uploading a photo or video in the "Discussion" of a public event. You could upload victim's video by changing `video_id`. The attached video was deleted when you deleted the event post.
- [Image removal vulnerability in Facebook polling feature](https://blog.darabi.me/2017/11/image-removal-vulnerability-in-facebook.html) by Pouya Darabi
  - The author noticed that "polling feature" was added to the posts while he was checking out Facebook's new features.
  - Whenever a user tries to create a poll, a request containing "gif URL" or "image id" will be sent; when this field value changes to any other "image id", that image will be shown in poll; after sending request with another user's "image id", a poll containing that image would be created; when we try to delete the poll, victim's image would be deleted.
- [Facebook Page Takeover by Manipulating the Parameter](https://arunsureshkumar.me/index.php/2016/09/16/facebook-page-takeover-zero-day-vulnerability/) by Arun Sureshkumar
  - "Facebook Page" are for brands, businesses, organisations and public figures to create a presence on Facebook, whereas profiles represent individual people. Anyone with an account can create a page or help manage one, if they've been given a role on the page like admin or editor. People who like a Page and their friends can get updates in "News Feed". With a "Facebook Page", you can easily show customers what you're all about.
  - "Facebook Business Manager" lets businesses more securely share and control access to their ad accounts, Pages, and other assets on Facebook. Anyone in a business can see all of the Pages and ad account they work on in one place, withour sharing login information or being connected to their coworkers on Facebook. When you sign into "Business Manager", we'll show you a quick overview of the ad accounts and Pages that you work on. If you're the admin for your business, go to "Business Settings" to add new people, Pages, ad accounts and other assets to your business.
  - When you added a partner to your own business, a request containing `parent_business_id` (your own business id), `agency_id` (your partner's business id) and `asset_id` (didn't know what kind of asset) in POST parameter was generated. If you changed `asset_id` to the `page_id` you wanted to hack, and also interchanged the `parent_business_id` and `asset_id`, Page would be added to the "Facebook Business Manager" of the attacker with permission role "Manager".
- [A Simple Bug On Facebook That Is Worth $8000 - Page Download](https://medium.com/@ajdumanhug/a-simple-bug-on-facebook-that-is-worth-8000-b77f7e01b064) by Aj Dumanhug
  - After knowing there was a "Download Page" new feature, the author immediately searched for bugs in the new feature the day after.
  - If you're an "Admin", you can download a copy of your Page. But the author found that you could download a copy of a Facebook Page when you're an "Editor".
  - When you downloaded your "Admin" Page, changed `page_id` to your "Editor" Page, then you could download a copy of your "Editor" Page.
- [Disclose Private Video Thumbnail from Facebook WorkPlace](https://medium.com/bugbountywriteup/disclose-private-video-thumbnail-from-facebook-workplace-52b6ec4d73b7) by Sarmad Hassan
  - The author decided to test "Facebook Pages", because he knew through reading a lot of writeups, that Facebook pay good bounty when hunters find valid bugs on "Pages".
  - He created a test Page for himself and checked every option on it. After a little while he got "CANVAS", basically "Page Admin" or even an "advertiser" can create "CANVAS" and there is some options like upload photo or video inside of it.
  - The author uploaded his test video and saved it, then he edited the "CANVAS" by changing the title, when committed, a request containing `video_id` was generated, changed the `video_id` to any public video id, he could uploaded that public video to his "CANVAS".
  - When the author deleted his CANVAS's video, the original video wasn't deleted, which means this uploaded bug was only a N/A.
  - Just thought outside the box, every post in "Facebook Workplace" consider as private, like photos or videos, because only members of a company with then same email domain should have see their posts. So the author changed the `video_id` to a video from his "Workplace" test account.
  - After he refreshed the page and clicked on view option to see if he can view the video, again he couldn't see the video but noticed that there was a spinning icon for the video, which means the video is uploaded successfully but there is something blocking it to be previewed.
  - The author sent his canvas to his "Smart Phone" (because there was an option to send a preview of your canvas to your mobile device). Once he sent the canvas to his Smart Phone, he received a notification in his phone telling him "your canvas is ready to preview", clicked on it and he saw the video in his device, but he couldn't play the whole video, he was only able to see "Video Thumbnail".
  - Ability to see the "video thumbnail" in "workplace post" consider as a security issue, cause imagine these videos contain private information like meeting places, private emails, private titles for the company like prices, budgets, products sales figures or any private information that should not be visible to the public, not to mention private content of the video itself.
- [Add description to Instagram Posts on behalf of other users - 6500$](https://medium.com/bugbountywriteup/add-description-to-instagram-posts-on-behalf-of-other-users-6500-7d55b4a24c5a) by Sarmad Hassan
  - "IGTV" was a new feature on Instagram for watching long-form, vertical video from your favorite Instagram creators.
  - Once the author created an "IGTV video", he clicked on the edit option, a request containing `media_id` (you could get any `media_id` for other users posts by just visiting their posts and viewing the source code), `caption` and `title` (you could put description to that video or photo in these two parameters) was generated.
  - By replacing his `media_id` to other users post's `media_id`, the author could add description to their posts if they didn't put any description there. It worked in all kind of posts like photos, videos and IGTV videos. It worked only on public accounts.
  - The response was an "Internal Server error" with an error message "Oops an error occured", but instead the bug worked.
- [How I was able to delete any image in Facebook community question forum](https://medium.com/@JubaBaghdad/how-i-was-able-to-delete-any-image-in-facebook-community-question-forum-a03ea516e327) by Sarmad Hassan
  - The author came across "Facebook community question forum" and posted an answer with attached photo, then a request contained `attachment` (`attachment={“fbid”:275252333010477}`) in POST parameter was generated, which `fbid` was the id of any uploaded photo in Facebook. Changed `fbid` number with other use's `fbid` attached photo, you could attach other user's photo.
  - Because attacker and victim had the same `fbid` number, so deleted posted answer from attacker account might also delete the attached photo of victim. But when the author deleted his posted answer and refreshed the victim account page, the photo was still there.
  - Then he thought maybe it would take some time to be deleted in victim account, and refreshed victim page more than one minute later, the photo got deleted.
  - This bug also worked on by photo uploaded by Facebook help team itself and also worked on "Facebook workplace".
  - The author explained how he got the `fbid` number of other users account. There is a relationship in the "image URL link" between "second number" in the "image URL link" and a constant number equal to "3333333".
- [Facebook: Creating Test Conversion using any App](https://medium.com/bugbountywriteup/creating-test-conversion-using-any-app-8b32ee0a735) by Joshua Regio
  - The "Facebook ad account test" can help you understand how many sales or conversions your Facebook, Instagram and Audience Network ads are causing.
  - A malicious user can create test conversion using any `app_id` which could reveal the sales and conversions of an active campaign.
  - Go to `facebook.com/test-and-learn/?act=AD_ACCOUNT_ID`; set up "Test"; fill in the necessary information; intercept the request before creating a test; in the `/ad_studies` request, change the `app_id` to your victim's `app_id`; "Test Conversion" is created.
- [Vulnerability in Youtube allowed moving comments from any video to another](https://www.secgeek.net/youtube-vulnerability/) by secgeek
  - The author wanted to think a little bit outside the box and find something in Youtube that not many bug hunters have tested, so he has decided to test the feature of "reviewing comments". Usually, the comments get posted immediately to the uploaded videos, but the author of the channel can control this by changing the settings to hold the comments for review before it gets posted. The author thought that not many researchers have tested that feature since it is not the default option.
  - When you approved the a comment on your video, a request containing `comment_id` and `video_id` (in the "POST" parameters) was generated. If you changed the `video_id` to any other video id, you would get an error. Yet, if you kept the `video_id` untouched and changed only the `comment_id` to any other comment id on any Youtube video, the request would get accepted and that comment would be copied and appear on you video.
  - The original comment from the original video didn't get removed, and the author of the commnent didn't get nonified that his comment is copied onto another video.
- [Microsoft-careers.com Remote Password Reset](http://yasserali.com/microsoft-careers-com-remote-password-reset/) by Yaaser Ali
  - The author opened the reset password link, entered his new password, fired up Burpsuite and intercepted the requested when summitted. There was `id` (only seven number and I thought it was increasing) in the POST request, with no authorisation key. Changed `id` to the ID of victim's account, you could reset password of that victim's account. 
- [One Vulnerability allowed deleting comments of any user in all Yahoo sites](https://www.secgeek.net/yahoo-comments-vulnerability/) by secgeek
  - This vulnerability affected 90% of Yahoo's services such as: "Yahoo News", "Yahoo Sports", "Yahoo TV", "Yahoo Music", "Yahoo Weather", "Yahoo Celebrity", "Yahoo Voices" and more. The vulnerability allowed attacker to delete any user comments in all these Yahoo sites.
  - When you deleted your comment, a request containing `comment_id` (in POST parameters) was generated, if you changed the `comment_id` to the other's comment, you could delete other's comment.
  - The vulnerability would only work if you were the first commenter on the article as you would have a privilege to delete any other Yahoo users' comments who posted comments after you. Otherwise it would give you the "Authorization Failed" error message. So it seems that the developer was taking care of the bug but he just forgot to add the validation when he checks if you were the first commenter.
- [Twitter Vulnerability Couldv Delete Credit Cards from Any Twitter Account](https://www.secgeek.net/twitter-vulnerability/) by Ahmed Aboul-Ela
  - Acctually the author found two vulnerabilities not one but both had the same effect and impact. Endpoint `ads.twitter.com`.
  - First Vulnerability. When you pressed the "Delete this card" button in payments method page, a request containing `account` (the twitter account id) and `id` (the credit card id, only 6 numbers and it was increasing) in POST parameters was generated, changed those two parameters to victim's account id and credit card id, the page response was "403 forbbiden" but the credit card was actually deleted from the victim's account without any interaction.
  - Second Vulnerability. When the author tried to add an invalid credit card to his twitter account it displayed an error message "we were unable to approve the card you entered" and showed a "Dismiss" button. When pressed the "Dismiss" button, a request containing `id` (the credit card id, only 6 numbers and it was increasing) in POST parameters was generated, changed `id` to the victim's credit card id, the victim's credit card got deleted.
- [How I took control of your Twitter account (tweeting, viewing/deleting photos and other media)](http://www.anandpraka.sh/2017/05/how-i-took-control-of-your-twitter.html) by Anand Prakash
  - "Twitter Studio" (`studio.twitter.com`) was a new product, the author started looking for vulnerabilities after the launch.
  - All requests on `studio.twitter.com` were sending a parameter name `owner_id` which was twitter user id (publicly available and sequential). `owner_id` parameter was missing authorisation checks changing which allowed attacker to tack actions on behalf of other twitter users.
- [PayPal BBP - I could’ve deleted All SMC messages](https://blog.ayoubaitelmokhtar.com/2018/06/paypal-bbp-i-couldve-deleted-all-smc.html) by Ayoub AIT ELMOKHTAR
  - PayPal has created a "Message Center" for its customers, like most financial institutions provide. The "Message Center" gives PayPal the ability to communicate with you within the framework of a new mailbox inside your PayPal account. It also provides you with a way to validate customer service emails that you may consider suspicious. This way, you can trust that the communications you receive are from PayPal itself.
  - How it works: emails from PayPal will be put into the "Message Center", a notification will be sent to let you know that you have a message.
  - When deleted a message, a request containing `message_id` (like "38223655") without "CSRF token" was generated. By changing `message_id`, an attacker could delete victim's message.
  - The proc in this writeup is worth to study.
- [Full account Takeover via reset password function](https://medium.com/@khaled.hassan/full-account-takeover-via-reset-password-function-8b6ef15f346f) by Khaled Hassan
  - When the author changed his password via password reset URL, a request containing `email` in POST parameter without any password reset token or authorization token generated. By changing the `email` the author could reset other user's password and takeover that accout. But a interaction was needed.
  - This system worked as follows:
    - User A starts resetting password of User B.
    - User B receives the reset link and clicks on it.
    - The server now will allow the User A to change the password of User B through this endpoint because the reseting URL verification is done.
    - When the user clicks on the password reset, this means to the server that the user has clicked on the reset URL that he requested for but in fact he didn't, the attacker who is requested the password reset. And after this happens User B can change his password through this endpoint without the need for any authorization tokens.
- [How I could have hacked 62.5 million Zomato Users](http://www.anandpraka.sh/2015/06/how-i-hacked-zomatocom-to-see-data-of.html) by Anand Prakash
  - While creating an account on "Zomato", a user can store his phone number, addresses, data of birth, link Instagram account, etc. In one of the API call, they were reflecting the data based on the `browser_id` parameter in the API request (how did the author figure out this?). Changing the `browser_id` sequentially resulted in data leakage of other Zomato users. The data leaked also had Instagram access token which sould be used to see priviate photos on Instagram of respective Zomato users.
- [IDOR While Connecting Social Account in Hackster.io](https://medium.com/@arbazhussain/idor-while-connecting-social-account-in-hackster-io-2296b316b7a7) by Arbaz Hussain
  - Create an account on Hackster.io with email, then logout.
  - Try to login into that accoutn with Facebook autho of same email, this time Hackster.io ask the user that "We've found existing user account registered on same email, link this two accounts". The URL of that page contained `/users/authorization/<user_id>/edit`, `<user_id>` was just like "199994".
  - By changing the `<user_id>` to any other account, an attacker could link his Facebook account to victim's email and takeover victim's account on Hackster.io.
- [Hunting Insecure Direct Object Reference Vulnerabilities for Fun and Profit (PART-1)](https://codeburst.io/hunting-insecure-direct-object-reference-vulnerabilities-for-fun-and-profit-part-1-f338c6a52782) by Mohammed Abdul Raheem
  - Delete victim's posts of website by changing `id` (id of a post, like "192230") in POST parameter when an attacker delete his own post.
  - Change victim's profile picture by changing `uid` (id of a user, like "13904") in POST parameter when an attacker upload his own profile picture.
  - Change victim's cover picture by changing `uid` (id of a user, like "13904") in POST parameter when an attacker upload his own cover picture.
  - Delete victim's profile picture and cover picture by changing `uid` in POST parameter.
- [Hunting Insecure Direct Object Reference Vulnerabilities for Fun and Profit (PART 2)](https://codeburst.io/hunting-insecure-direct-object-reference-vulnerabilities-for-fun-and-profit-part-2-af832d1c0bb6) by Mohammed Abdul Raheem
  - Comment on victim's post by changing `streamid` (id of a post, like "192263") in POST parameter even that post has "only-me" privacy.
  - Change victim's post privacy by changing `streamid` (id of a post, like "192263") in POST parameter when an attacker click "only-me" option on his own post.
  - Repost any post more than one time by changing `id` (id of a post, like "192230") in POST parameter to an id of post which is already reposted when repost a post.
- [How I Get the Name of the Hotel (and other Data) that you ever Stay](https://medium.com/@YoKoKho/idor-at-private-bug-bounty-program-that-could-leads-to-personal-data-leaks-d2536d026bf5) by YoKo Kho
  - When the author saw that the program has been launch since September 2015, he really losted the interest to participate. But when he saw the resolved report were only 29, he thought "why not give it a try".
  - The author had a deep understand to the business logic.
  - By changing `payment_id` (changed from "4055809" to "4055311"), then automatically the system will generate the other user's booking number that could be used to enumerate the data that has the relation with those booking number.
- [IDOR User Account Takeover By Connecting My Facebook Account with victims Account](https://blog.securitybreached.org/2018/09/16/idor-account-takeover-using-facebook/) by Muhammad Khizer Javed
  - An IDOR issue in a Web where changing the "User ID" in Facebook auth callback linking request actually connected the author's "Facebook Account" to the "Victims Site Account", so by this he could get complete access to "User Account".
  - When the author tested a web app, he realised that the website idefified a user from a unique `_user_id`, the value for this ID was something like `aff20-33f3-4c8e-b3cb-77b2`. So he checked in which request this `_user_id` got passed and came accross Facebook auth callback linking request. Changed the `_user_id` to another user's account, the author could connect his Facebook account to another user's account and tookover that account.
  - But how an attacker got victim's `_user_id`. The author tested many public endpoints to check if any contained the `_user_id` but couldn't find any, then he opened an image shared by the user (victim) and opend the actual URL of the image, ita was hosted on an "S3 Bucket" and the image always had the `_user_id` in the URL.
- [Paytm Customer Information is at risk — India’s largest digital wallet company](https://medium.com/@logicbomb_1/bugbounty-paytm-customer-information-is-at-risk-indias-largest-digital-wallet-company-6f7116d4b2d5) by Avinash Jain
  - When the author required his bill information, a request containing `recharge_number_2` (mobile number) and `recharge_number` (account number) in POST parameters was generated. By only changing `recharge_number` (account number), the author was able to fetch complete bill details of some other user associated with that account number.
- [How Naaptol (India’s popular home shopping company) Kept their Millions of User Data at Risk](https://medium.com/@logicbomb_1/bugbounty-how-naaptol-indias-popular-home-shopping-company-kept-their-millions-of-user-data-e414cd4151c) by Avinash Jain
  - Just like every online shopping website has the functionality of allowing the user to select the address where he wants to ship the product, Naaptol also has the same thing. When the author selected an address to ship the product, a request containing `addressId`  (like "17917835") was generated. By changing the `addressId` to some other number, the author was able to see full details of other user associated with that ID, which included sensitive information like victim's full name, complete address, mobile number etc.
- [Abusing internal API to achieve IDOR in New Relic](https://www.jonbottarini.com/2018/01/02/abusing-internal-api-to-achieve-idor-in-new-relic/) by Jon Bottarini
  - The author usually test for IDOR's this way, by having one browser (usually Chrome) setup as "victim account" and another browser (usually Firefox) as the "attacker account", where he route everything throught Burp and check the responses after he change values here and there.
  - New Relic implemented an "internal API" which occured on both their "infrastructure product" (`infrastructure.newrelic.com`) and "alerts product" (`alerts.newrelic.com`). There were multiple version of the "internal API", the bug only worked on version 1.
  - The vulnerable endpoint contained "account number" which increases by 1 every time a new account is created. The application didn't ensure that the "account number" being requested through the "internal APT" GET request matched the "account number" of the authenticated user.
- [Rewarded by securing vulnerabilities in Bookmyshow (India’s largest online movie & event booking portal)](https://medium.com/@logicbomb_1/bugbounty-rewarded-by-securing-vulnerabilities-in-bookmyshow-indias-largest-online-movie-bb81dba9b82) by Avinash Jain
  - Bookmyshow has the functionality by which a logged-in user can share their experiences.
  - By accessing the URL `https://in.bookmyshow.com/national-capital-region-ncr/experiences/create/{victim experience id}`, the author got the complete control / access over victim's experiences, he could edit he name, upload any image, write any description and etc.
- [How I was able to read chat of users in an Indian Online travel portal](https://medium.com/bugbountywriteup/bugbounty-how-i-was-able-to-read-chat-of-users-in-an-online-travel-portal-c55a1787f999) by Avinash Jain
  - The author came across an interesting IDOR vulnerability that could aid him to read the complete chat of the users with the customer support team of an Online Travel company.
  - While browsing through a company's website, the author found an online chat forum, that allows customer to chat online with the support team to query about one's bookings, payments, refund, etc. That tricked him to extract user's sensitive data. The first thing that hit his mid was "how can a user read other users' chat".
  - When triggered the online chat functionality, a request:
    - `https://private.com/yconnect/messages/before/hari013903158/FL-132756/?callback=angular.callbacks._d&format=jsonp&size=50&userType=UT_CUST`
    - The response of the above request was the conversation messages exchanged during the chat.
  - While traversing more, he realized that: `hari013903158` was the "customer id", `FL-132756` came out to be the "chat id" chich on further analysis found to be incremental.
  - Found the valid "customer id". The author went back to the login page, profile section, to see if it can help, but nothing. Then he came "blog section" (traveller's blog page where people share their traveling stories). He opened on blog which was published by one user, he could see the "user id" in the URL itself.
  - Replaced the "customer id" in previous request and brute-forced "chat id". Done.
- [Ribose — IDOR with Simple CSRF Bypass — Unrestricted Changes and Deletion to other Photo Profile](https://medium.com/@YoKoKho/ribose-idor-with-simple-csrf-bypass-unrestricted-changes-and-deletion-to-other-photo-profile-e4393305274e) by YoKo Kho
  - Ribose give the long "User ID" (the very complex "User ID" to be guessed, like "0b03d802–3e29–4564-xxxx-x1x1x1x1x1x1") that generated automatically when someone signing up their platform. But any user at this platform could see the other "User ID" when we try to visit a user.
  - When a user delete their own photo profile, automatically the system will send the "DELETE" method to the server with the "User ID" and `X-CSRF-Token`. In theory, it's not possible for attacker to delete other user's photo profile without the knowledge of victim's `X-CSRF-Token` that (should) restric to each session. But in this situation, by (only) changing the "User ID" into the victim's "User ID", then the deletion process still executed by the system.
  - When a user upload their own photo profile, authomatically the system will send the "POST" method to the server with the "User ID", `authentication_token` and `X-CSRF-Token`. In theory, it's not possible for attacker to upload the picture into other user's photo profile without the knowledge of victim's `authentication_token` and `X-CSRF-Token` that (should) restrict to each session. But in this situation, by (only) changing the "User ID" into the victim's "User ID", then the upload process still executed by the sytem.
  - Always try to change our "User ID" to another "User ID" (as long the victim's ID are easily predicted or could be found) even the targeted application has implemented the "CSRF Token" that commonly used for restrict the session.

### Cross-Site Request Forgery (CSRF)

- [10 Methods to Bypass Cross Site Request Forgery (CSRF)](https://haiderm.com/10-methods-to-bypass-cross-site-request-forgery-csrf/) by Haider Mahmood
  - Randomness of Anti-CSRF token
    - Sometimes the backend validation only checks for the length of the Anti-CSRF token for its validation, a quick check for this is to change one character of the token and repaly.
    - Often the Anti-CSRF token is composed of two parts, one of them remains static while the other one dynamic, if you remove the dynamic part of the token and send the request with only the static part, it often works thanks to poor back-end validation.
  - Exploiting poor implementation
    - Replay attacks, this simply means that attacker is able to use the same Anti-CSRF token for a number a request, by exploiting this issue attacker can simply use the same Anti-CSRF token in crafted HTML form for the attack.
    - Sometimes the application wouldn't even check if the Anti-CSRF token parameter is present in the request or not.
  - CSRF bypass by leveraging other vulnerabilities
    - One could obtain Anti-CSRF tokens leveraging XSS vulnerabilities, such attack works even if Anti-CSRF token is per request based.
    - In cases where cookie attributes are used to submit Anti-CSRF token, if a vulnerability in application allows an attacker to do "header injection", this would also lead to user supplied cookies, attacker can set its own CSRF values in cookie resulting in Anti-CSRF token bypass.
    - Verb tampering (coverting GET to POST and vice versa) is another way one could bypass CSRF.
- [How I bypassed Facebook CSRF Protection](https://blog.darabi.me/2015/04/bypass-facebook-csrf.html) by Pouya Darabi
  - Normally, `fb_dtsg` (anti-CSRF token) is supposed to get validated at server-side and if an action request doesn't contain that token, Facebook will drop that request withour any process on it.
  - When updated gray account to personal account, a request containing `account_id=XXXX` in URL and body in POST parameters was generated. Changed `account_id=XXXX` to `aaaa=XXXX`, the author could bypass Facebook CSRF protection (what was the logic behind the scene?).
  - All action could be used here, example list:
    - change language: `/ads/manage/home/?show_dialog_uri=/ajax/settings/account/language.php?new_language=fa_IR`
    - add email: `/ads/manage/home/?show_dialog_uri=/settings/email/add/submit/?new_email=pouya@darabi.me`
    - turn off login approval: `/ads/manage/home/?show_dialog_uri=/ajax/settings/security/approvals.php?just_enabled_approvals=0`
    - logout all mobile: `/ads/manage/home/?show_dialog_uri=/ajax/settings/mobile/lost_phone.php`
    - logout all sessions: `/ads/manage/home/?show_dialog_uri=/ajax/settings/security/sessions/stop_all.php`
  - The author couldn't change prefix after Facebook fixed this issue, `show_dialog_uri` should have prefix `/ads/manage/error/graydisabled/?`.
  - The author bypassed the fix with double encoding (`?` -> `%253F`), added email:
    - `https://www.facebook.com/ads/manage/home/?account_id&show_dialog_uri=%2Fads%2Fmanage%2Ferror%2Fgraydisabled%2F%253F%2F..%2F..%2F..%2F..%2F..%2Fsettings%2Femail%2Fadd%2Fsubmit%2F%3Fnew_email%3Dpouya%40darabi.me`
  - Facebook security fianlly removed `show_dialog_uri`.
- [How I bypassed Facebook CSRF once again](https://blog.darabi.me/2016/05/how-i-bypassed-facebook-csrf-in-2016.html) by Pouya Darabi
  - A "continued flow lead ad" means the final step is completed on the advertiser's website. The "lead ad" will collect all of the data provided and pass it to a destination URL using a hash or POST request. This is valuable for flows where you need data that Facebook is unwilling to collect (e.g. password for creating an account).
  - Facebook's POST method was used in "continued flow" and `fb_dtsg` was added to every request.
  - Whenever a user creates "lead ad form", a JSON object contains data were sent to create endpoint. Fortunately the author found another endpint to get created forms as JSON.
    - Endpoint URL: `https://facebook.com/ajax/settings/timeline/review.php`, Body: `tag_approval_enabled=0`
    - Final URL: `https://facebook.com/ajax/settings/timeline/review.php?tag_approval_enabled=0&__a=1`
    - There was no server side check for the "Final URL".
- [Messenger.com CSRF that show you the steps when you check for CSRF](https://whitton.io/articles/messenger-site-wide-csrf/) by Jack Whitton
  - The way the author normally check for CSRF is as follows:
    - Perfrom the request without modifying the parameters, so we can see what the expected result is
    - Remove the CSRF token completely (in this case, the `fb_dtsg` parameter)
    - Modify one of the characters in the token (but keep the lenght the same)
    - Remove the value of the token (but leave the parameter in place)
    - Convert to a GET request
  - By submitting a request to change a setting without `fb_dtsg`, the author found that `fb_dtsg` was missing on every request on `www.messenger.com`.
- [Paypal bug bounty: Updating the Paypal.me profile picture without consent (CSRF attack)](https://hethical.io/paypal-bug-bounty-updating-the-paypal-me-profile-picture-without-consent-csrf-attack/) by Florian Courtial
  - There are two different websites: `paypal.me` and `paypal.com`. On `paypal.me` you are able to manage a reduced list of settings for your page such as the picture displayed, the background color, etc. On `paypal.com` you are able to manage your personal information such as your address, phone number, etc, but also your profile picture. The same picture is used in both places.
  - The author didn't find any CSRF on `paypal.me`, but on `paypal.com`, he found out that when removing or editing the "CSRF token" (http header in that case) theree was no error and the profile picture was updated.
  - Using this vulnerability it was possible to update the profile picture of a `paypal.me` user without conset after him / her following your link.
  - The proc in this writeup is worth to study.
- [Hacking PayPal Accounts with one click (Patched)](http://yasserali.com/hacking-paypal-accounts-with-one-click/) by Yasser Ali
  - The "CSRF token" that authenticate every single request made by the user which can be also found in the request body of every request with the parameter name "Auth" get changed with every request made by user for security measures. But after a deep investigation the author found out that the "CSRF Auth" is reusable for that specific user email address or username, this means if an attacker found any of these "CSRF Tokens", he can then make actions in the behalf of any logged in user.
  - The "CSRF Auth" verifies every single request of that user, so if an attacker not logged in tries to make a "send money" request then PayPal will ask the attacker to provide his email and password. The attacker provides the victim's email and any password, then captures the request, the request will contain a valid "CSRF Auth token" which is reusable and can authorise this specific user requests.
  - Through examination of the password change process, the author found that an attacker can not change the victim password without answering the "security question" set by user. Also the user himself can not change the security questions without entering the password.
  - After further investigation, the author noticed that the request of setting up the security questions which is initiated by the user while signing up is not password protected, and it could be reused to reset the security questions without providing the password. Hence, armed with the "CSRF Auth", an attacker can CSRF this process too and change the victim's "security questions".
  - At this point, an attacker can conduct a targeted CSRF attack against PayPal users and take a full control over their accounts.
- [How I was able to delete anyone’s account in an Online Car Rental Company](https://medium.com/bugbountywriteup/bugbounty-how-i-was-able-to-delete-anyones-account-in-an-online-car-rental-company-8a4022cc611) by Avinash Jain
  - The author went through "Update Profile" functionality and a request containing `_method=put` in POST parameters was generated. The mothod `put` suggested creating a new resource or replacing a representation of current resource with the requested data. By changing `put` into `delete`, account was delete, in actual there was no such functionality which allowed user to deactive his account.
  - Now the next challenge was to do the same thing but to other user's account. There were also `user_name` and `csrf_token` in POST parameters in previous request, by changing `user_name` to other user's and removing `csrf_token` value, the author could delete other user's account.
  - The proc in this writeup is worth to study.

### Sensitive Information Exposure

- [FB users birth year disclosed via FB Timeline profile source code “data attribute”](https://medium.com/@rajsek/curiosity-and-passion-to-your-profession-might-lead-to-make-your-dream-come-true-7d9be3c6029a) by Raja Sekar Durairaj
  - The author could extract the "birth year" of any others irrespective of their privacy settings.
  - The author got a facebook birthday notification of his mentor. Somehow he got interests to know his mentor's age and then he searched for his mentor's birth year in facebook, it seems his mentor intentionally hide the "birth year" to others. The author's instict said that there should be some way to get his mentor's birth year, so he started analysing FB timeline.
  - Facebook is following some patter / order to display the post in timeline, the author started to look into the source code of the "birth timeline" post of his mentor.
  - The author noticed a bunch of few "junk number" in the souce code. Then he started explore those "junk numbers" and found the pattern in those numbers was: `"thid":"Fb_User_ID:306061129499414:32:126210600:157746600:Birth_Post_ID"`.
  - He guessed that `32:126210600:157746600` in the above strings might be a "UNIX representation of time" (how did he guess that?), so he decoded the string. Then he thought FB developer might trimmed the last few digits, so he started repeating the decoding process by appending zeros at the end. His third attempt gave him the exact "birth year" of his mentor.
    - This method probably could be used in other scene.
  - The author automated the process using google extension (there is a piece of Javacript code but no google extension example).
  - This bug was present in all FB platfroms (Android, Web, Mobile Web - `m.facebook.com`).
- [FB user birth year Disclosure via "IDOR in m.facebook.com"](https://medium.com/@rajsek/my-2nd-facebook-bounty-poc-fb-data-of-birth-disclosure-d02e1bec50) by Raja Sekar Durairaj
  - To comfirm the fix on the previous bug, the author tried to analyse on "Facebook mobile website" (`m.facebok.com`) timeline pattern.
  - `https://m.facebook.com/UserID/year/<actual Year>` gave the post and life time event happened in that timeline.
  - Changed the `<actual Year>` with victim's `UserID`, returned the victim's birth post on their birth year.
- [DOB disclosed using "Facebook Graph API Reverse Engineering"](https://medium.com/@rajsek/my-3rd-facebook-bounty-hat-trick-chennai-tcs-er-name-listed-in-facebook-hall-of-fame-47f57f2a4f71#.9gbtbv42q) by Raja Sekar Durairaj
  - Facebook uses "graph API" to fetch the user data from their system. To monitor the "Facebook timeline API" behaviour, the author logged the request and response of the FB Android application in his system. And he found that "Facebook graph timeline API" is following some pattern to fetch user post from their system. Using the pattern attacker can disclose the "birth year" of any user in Facebook.
  - This method is not applicable for me at this time, just keep this series as a series.
- [Facebook's Bug - Fooling Graph Search to Bypass Privacy Restrictions & Extract Private Information](https://pranavhivarekar.in/2016/02/20/facebooks-bug-fooling-graph-search-to-bypass-privacy-restrictions/) by PRANAV HIVAREKAR
  - "Facebook Graph Search" is smart search tool allows people to see what their friends are doing. "Graph Search" simply works on "Set Theory", so it is possible to fire queries which adhere to "Set Theory" and are successfully executed and make the search engine return result set back.
  - The author was able to fool "Facebook Graph Search" and bypass privacy restrictions and extract sensitive information about user's applications and pages. He was able to get `applications used` by any user, regardless of privacy settings set to `Only me` and also he was able to ge `Pages liked` by user, regardless of privacy settings set to `Only me`.
  - Intersection of two sets was handled properly and didn't show any private information using privacy `Only me` or other.
    - `https://www.facebook.com/search/me/apps-used/100002065051535/apps-used/intersect`, this took common-set (intersection) of `apps-used` by the author and `apps-used` by `100002065051535` and returned a result set.
  - Union of two sets exposed private data. Given an app's visibility is set to `Only me`, was till returned in result set.
    - `https://www.facebook.com/search/me/apps-used/100002065051535/apps-used/union`, this returned few applications which were used by the author or `100002065051535`.
  - On user profile, a user is allowed to like pages which are of categories Apps and games, Movies, TV shows, Music, Books, Sports, etc. These pages are sorted according to categories and are addressed as individual elements. Books, Music, Sports are different entities and each entity has an option of privacy, an user can select any privacy for any entity. The author was able to extract any user's personal information, regardless of privacy settings. It included `Books` he / she read, `Movies` he / she watched.
    - `https://www.facebook.com/search/100002065051535/pages-liked/str/Taarak Mehta Ka ooltah Chashma/keywords_pages/union`
- [Responsible disclosure: retrieving a user's private Facebook friends](https://rpadovani.com/facebook-responsible-disclosure) by Riccardo Padovani
  - Your Instagram and Facebook accounts are somehow linked: it happens both if you sign up to Instagram using you Facebook acoout, also if you sign up to Instagram creating a new acount but using the same email you use in your Facebook accout (there are also other way Instagram links your new accout with an existing Facebook accout).
  - When you subscripe to Instagram, it will suggest you who to follow based on your Facebook friends.
  - Instagram used to enable all its feature to new users, before they have confirmed their email address. One of the features available before confirming the email address was the suggestion of who to follow based on the Facebook friends of the account Instagram automatically linked.
    - This made super easy to retrieve the Facebook's friend list of anyone who doesn't have an Instagram account. And since there are more than 2 billions Facebook accounts but just 800 millions Instagram accounts, it means that at least 1 billion and half accounts were vulnerable.
- [FACEBOOK BUG BOUNTY: "GETTING ACCESS TO PROMPT DEBUG DIALOG AND SERIALIZED TOOL ON MAIN WEBSITE FACEBOOK.COM"](http://omespino.com/facebook-bug-bounty-getting-access-to-prompt-debug-dialog-and-serialized-tool-on-main-website-facebook-com/) by OMESPINO
  - The author enumerated some Instagram subdomains, then pick up one, logged in the "Facebook login" and the login took him to the "main" `facebook.com` page and showed some debugs prompts and some tools and missing dependencies while he was scrolling in the new feeds.
  - This seems recon wins.
- [Facebook BugBounty — Disclosing page members](https://medium.com/@tnirmalz/facebook-bugbounty-disclosing-page-members-1178595cc520) by Nirmal Thapa
  - Because of some privacy reasons, identify of "page members" (admins / mods / analysts) is kept secret by Facebook and normal page visitors cannot find the details about these members. But the author found multiple ways to disclosed members of a "Facebook page".
  - "Get Messages" is available in "Facebook Pages" when uploading posts and stuffs. Mainly e-commerce and online shopping websites use this feature with one of their product, so whenever a visitor wants to know more about that particular product, they can simply click on "Send Message" button.
    - If clicked on "Send Message" button, "profile ID" of the creator was leaked in one of the responses coming from `https://x-edge-chat.facebook.com` (checked the response in Burpsuite).
  - The author sent a message to the page as a normal visitor, when he received a message from the page, response in Burpsuite revealed the "profile ID" of "page member" who replied the message.
- [Misconfigured JSON endpoint on ads.twitter.com lead to Access control issue and Information Disclosure of role privileged users](https://medium.com/@zk34911/twitter-bug-bounty-misconfigured-json-endpoint-on-ads-twitter-com-2771ec83a82) by zk34911
  - "Twitter Ads Program" enables a user / original "Account administrator" to grant role privileges and permissions to manage their Twitter Ads account.
  - Information only accessed by privileged user exposed to other users by accessing a specific endpoint.
- [How I used a simple Google query to mine passwords from dozens of public Trello boards](https://medium.freecodecamp.org/discovering-the-hidden-mine-of-credentials-and-sensitive-information-8e5ccfef2724) by Kushagra Pathak

### Business Logic Flaw

### Brute Force

### Clickjacking

### Open Redirection

- [Use Two Open Redirects to Trigger an XSS in Google website - Open redirects that matter](https://sites.google.com/site/bughunteruniversity/best-reports/openredirectsthatmatter) by Tomasz Bojarski
  - This is a complicated writeup writen by Google security engineer, with detailed techques analyzing.
  - The writer started with the report, analyzing how the proc finally was triggered. The reader could even read the source code of the website.
  - To bypass the prefix check, using `https://picasaweb.google.com/data/feed/api/../../../bye`.
  - To bypass the prevention of MIME sniffing vulnerabilities, triggering an error. The error message should contain HTML code.
  - Open redirects are super useful in bug chains, especially when used to bypass a prefix-based URL whitelist.
  - It's also useful to set up your own server to respond with various invalid header valuse, as not everything can be tested using a tampering proxy alone.
- [dev.twitter.com - Open Redirect and XSS](https://blog.blackfan.ru/2017/09/devtwittercom-xss.html) [hackerone report](https://hackerone.com/reports/260744) by Sergey Bobrov
  - Twitter XSS by stopping redirection and Javascript scheme. A table showed the way the author walked through.
  - Having created a link with an incorrect port in the "Location header", the author managed to block the redirection in FireFox browser.

### Server Side Request Forgery (SSRF)

- [HOW TO: SERVER-SIDE REQUEST FORGERY (SSRF)](https://www.hackerone.com/blog-How-To-Server-Side-Request-Forgery-SSRF) by Jobert
  - SSRF is a vulnerability class that describes the behavior of a server making a request that's under the attacker's control. It happens that an online application requires outside resources. For example, when you's tweet a blog post, a avatar would show up for that post on Twitter. The image, title, and description come frome the HTML that his page returns. In order to download that information, a Twitter server makes an HTTP request to that page and extracts all the information it needs. 
  - A good demonstration of an SSRF vulnerability is to reveal a system that is not accessible over the internet. Whenever you want to achieve this, keep the program's policy in mind and don't overstep any boundaries. If you do want to look for internal services, here's a list of private IPv4 networks that you could scan for services:
    - `10.0.0.0/8`
    - `127.0.0.1/32`
    - `172.16.0.0/12`
    - `192.168.0.0/16`
  - To discover which networks are routed internally, try looking at the time difference in responses.
    - Unrouted networks are often dropped by the router immediately (small time increase).
    - Internal firewalling rules often cause routed networks to increase the RTT (bigger time increase).
    - Also, remember that routers and switches often have an HTTP or SSH interface enabled, so it often pays off to try `.1` and `.254` addresses on port `22`, `80`, `443`, `8080`, and `8443` first.
  - More and more companies host part of their infrastructure on Amazon EC2. Amazon exposes an internal service every EC2 instance can query for instance metadata about the host.
    - Here's the [AWS documentation](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html).
  - Not all SSRF vulnerabilities are using the HTTP protocol. Sometimes, it's possible to either specify a different protocol or switch protocols with a redirect.
    - A cool pivot to escalate the SSRF to RCE is by pushing asynchronous jobs on the "Redis" queue that then get executed by an application using the `gopher://protocol`. It's really convenient that a lot of "Redis" instances don't use any form of authentication.
- [SSRF to query google internal server](https://www.rcesecurity.com/2017/03/ok-google-give-me-all-your-internal-dns-information/) by rcesecurity
  - A SSRF vulnerability on `toolbox.googleapps.com` which could be used to discover and query internal Google DNS servers to extract all kinds of corporate information like used internal IP addresses across the company as well as A and NS records exposing all kinds of hosts like Google's Active Directory structures and also a fancy Minecraft server.
  - "G-Suite Toolbox" can be used to perform all kinds of trouble-shooting. Among all the availabe tools, there is one called "Dig" which on Linux can be used to query a DNS server for its records of a given domain, just like A- or MX records.
  - If you filled "Name server" with `127.0.0.1`, you were trying to query `127.0.0.1` for DNS records, the web application simply responds with a "Server did not respond" message. So it really looks like the tool is trying to connect to `127.0.0.1:53` to fetch the DNS information for his domain, this smells like a SSRF (Think twice on error message).
  - Used Burpsuite's intruder to brute-force IP addresses ("nameserver" in POST parameter), the author found one promising internal IP, which responded to the request, however just with an empty A recored for his domain. Since the author knew about his own domain very well, it's even more interesting to find out whether it's possible to extract some internal information from Google, which are not publicly available.
  - Google is using `corp.google.com` as their corporate domain. Now you could brute-force all subdomains of `corp.google.com` using the very sam POST request to discover more subdomains.
  - The author used his own domain to brute-forece IP address and found a Google internal DNS, then used the Google internal DNS to extract Google internal information.
  - The product feature is related to this vulnerability.
- [Into the Borg – SSRF inside Google production network](https://opnsec.com/2018/07/into-the-borg-ssrf-inside-google-production-network/) by Enguerran Gillier
  - "Google Caja" is a tool to securely embed arbitrary html / javascript in a webpage.
  - "Google Caja" parses html / javascript and modifies it to remove any javascript sensitive content, such as iframe or object tafs and javascript sensitive properties such as `document.cookie`. "Caja" mostly parses and sanitizes HTML tags on the client side. However, for remote javascript tag (`<script src="xxx">`), the remote resource was fetched, parsed and sanitized on the server-side.
  - The author tried to host a javascript file on his server (`https://attacker.com/script.js`) and check if the Google Sites server would fall for the XSS when parsed server-side, but the server replied that `https://attacker.com/script.js` was not accessible.
  - After a few tests, the author realised that the "Google Sites Caja server" would only fetch Google owned resources like `https://www.google.com` or `https://www.gstatic.com`, but not any external resource like `https://www.facebook.com`. That's a strange behavior because this functionality is meant to fetch external resources so it looks like a broken feature. More interstingly, it is hard to determine whether an arbitrary URL belongs to Google or not, given the breadth of Google services.
    - Anyway the only explanation for the weird behavior of the "Google Caja server" was that the fetching was happening on the internal Google network and that is why it could noly fetch Google-owned resources but not external resources.
  - Whenever the author find an endpoint that fetched arbitrary content server-side, he always tests for SSRF.
  - Using "Google Cloud" services, it's very easy to host and run arbitrary code on Google servers. The author created a "Google APP Engine" instance and hosted a javascript file. He then used the URL of this javascript file on "Google Sites" as an external script resource. The javascript was successfully fetched and parsed by "Google Caja server". The author checked his "Google App Engine" instance logs to see from where the resource was fetched, it came frome `10.x.x.201`, a private network IP.
  - The author used the private IP as the URL for the "Google Sites" javascript exteranal resource. The request took more than 30 seconds to complete. When "Google Caja" replied, he saw 1MB infromation comming from a `10.x.x.x` IP from Google internal network, it was private information from Google.
  - The author didn't scan Google's internal network. He only made 3 requests in the network to confirm the vulnerability and immediately sent a report to "Google VRP".
    - The first request was to  `http://10.x.x.201/`. It respond with a server status monitoring page of a "Borglet".
    - The second request was to `http://10.x.x.1/` and it was also a monitoring page for another "Borglet".
    - The third request was to `http://10.x.x.1/getstatus`, a different status monitoring page of a "Borglet" with more details on the jobs like permissions, arguments.
- [Yahoo! When Server Side Request Forgery combine with Cross Site Scripting](http://web.archive.org/web/20170218205059/http://ngailong.com/what-could-happen-when-server-side-request-forgery-combine-with-cross-site-scripting/) by Ron Chan
  - `GET /d/xxxxxxxx/xxxxxxx?appid=YMail&crumb=kPun5CrTk1R&wssid=&clientId=mailsearch&timezone=Asia%2FHong_Kong&allowGoogleDocs=1&ymreqid=a5551380-75ce-13d6-1c16-c00001016500&url=http%3A%2F%2Fprod.mail.bf1.yahoo.com%2Fglasd%3f%2F%3FaccountIds%3D1%26timezone%3DAsia%252FHong_Kong%26mailboxid%3DBjJ-0j4oSqYSwadMXdzKCqzxjQ0gZZDkccM7CRStMSDerKbSfJwDAjhyiIZLOLd5xlNdGH4nkLovJSeSm65J69qU1w%26appid%3DYMail%26query%3Dis%253Aunread%26limit%3D50%26excludefolders%3DARCHIVE%26threads%3Dtrue%26vertical%3DMESSAGES%26order%3Dtime%2Bdesc%26cursor%3D49&listContentType=IMAGE`
    - The author could control the destination of the URL, by changing `http%3A%2F%2Fprod.mail.bf1.yahoo.com%2F` to `http%3Amysite.com`. A request from Yahoo owned server made to his server, and included all of Yahoo header in the request.
    - This is vulnerable to internal scanning as well, `http://127.0.0` didn't work, but `http://::80` worked, this is ivp6, bypassed the `127.0.0.1` check.
  - I think this is an open redirection lead to SSRF.
- [How i found an SSRF in Yahoo! Guesthouse (Recon Wins)](https://medium.com/@th3g3nt3l/how-i-found-an-ssrf-in-yahoo-guesthouse-recon-wins-8722672e41d4) by Th3G3nt3lman
  - "Yahoo Guesthouse" is a set of administration tools use by Yahoo on a daily basis. They allow Yahoo administrators to control all aspects of the Yahoo network, from mail and hosting accounts to server settings and hosting management. Certain parts of the system, such as error reporting tools, are also available to Yahoo's customer services team.
  - The auhor found a subdomain `https://alpha.keyserver.yahoo.com/`, when opened it got "Not Found" response. So he did "dirsearch" and found a SAML endpoint `https://alpha.keyserver.yahoo.com/saml` that redirected him to the "Yahoo Guesthouse" login page. The author couldn't break the SAML, but he decided to stay and dig more and mor in this.
  - When the author checked the request in burp, he found something special in the GET request for the above endpoint. There was a cookie `BouncerSAMLRemoteSessionHost=bouncer12-os.gh.bf2.yahoo.com;`, the cookie value was a website / yahoo subdomain, so ther was a high chance for an SSRF here. The auhor added his own server IP address in the `BouncerSAMLRemoteSessionHost` cookie, then received a request from `dip2.gq1.yahoo.com`.
  - The author tried to read files or escalate this SSRF but he couldn't. But SSRF in cookie seems intersting.
- [Airbnb – Chaining Third-Party Open Redirect into Server-Side Request Forgery (SSRF) via LivePerson Chat](https://buer.haus/2017/03/09/airbnb-chaining-third-party-open-redirect-into-server-side-request-forgery-ssrf-via-liveperson-chat/) by Brett Buerhaus
  - The author found some endpoints in a JS file.
  - A a bit of fuzzing, he discovered an error message on `https://www.airbnb.com/chat.asdf` that reminded him "LivePerson" he tested in the past. There was an open redirect in "LivePerson": `http://sales.liveperson.net/hc/5198728/?cmd=file&file=visitorWantsToChat&onlineURL=//xss.buer.haus/ssrftest&site=5198728`.
  - After going throught the API docs, the author discovered that `visitorWantsToChat` action would cause a header redirect with request parameter `onlineURL`, so open rediret to SSRF: `https://www.airbnb.com/chat?cmd=file&file=visitorWantsToChat&onlineURL=https://xss.buer.haus/ssrf&site=5198728` (why is this a SSRF).
  - The author didn't reveal many details, just study the method.
- [SSRF to LFI](https://seanmelia.wordpress.com/2015/12/23/various-server-side-request-forgery-issues/) by seanmelia
  - The first SSRF allowed the author to view local files on the host as well as port scan internal hosts. He read `/etc/passwd` using file protocol and brute-forced for `/porc/self/fd/{number}` (log files) using "Burpsuite Intruder".
  - The second SSRF had some filtering of `127.0.0.1` and `localhost` which was bypassed by using `0.0.0.0`.
  - The author didn't explain in details.
- [SSRF to pivot internal network](https://seanmelia.files.wordpress.com/2016/07/ssrf-to-pivot-internal-networks.pdf) by seanmelia
  - The author noticed the `js.example.com` site was loadng some external json for the `help.example.com` site: 
    - `http://js.examplecom/redacted/proxy?c=subdomain1&r=/jsonpfile.jsonp?token=undefined`
  - The author changed the `r` parameter to another external resourc: `http://google.com`, the error message showed the site tried to load `http://subdomain1.private.comhttp://google.com`. He figured he might as well change the `c` parameter from `subdomain1` to `www`, then the site reached Google.
  - He then used file protocol to read local files: `c=www&r=file:///etc/password`.
  - Localhost also worked: `c=www&r=http://127.0.0.1`.
  - The author used "Burpsuite Intruder" to brute-force subdomains, then used this SSRF to access some datastores: `c=www&r=http://subdomain2.private.com/`.
  - I think the author went over.
- [SSRF tips from BugBountyHQ of Images - Open Graph Protocol is a good case for Blind SSRF / Extract of Meta Data](https://twitter.com/BugBountyHQ/status/868242771617792000) by BugBountyHQ
  - [The Open Graph protocol](http://ogp.me/)
- [ESEA Server-Side Request Forgery and Querying AWS Meta Data](https://buer.haus/2016/04/18/esea-server-side-request-forgery-and-querying-aws-meta-data/) by Brett Buerhaus
  - The author used "Google dork" (example: `site:https://play.esea.net/ ext:php`) for recon and found an endpoint `https://play.esea.net/global/media_preview.php?url=`. It looks like an endpint for loading external images and displaying it back to the client.
    - That means there was a good chance they were taking user iput (`url` param), loading the response content, and rendering it back to the user.
  - The author tried `https://play.esea.net/global/media_preview.php?url=http://ziot.org/`, but it didn't work.
    - Looking through the Google search results again, he realized that all the results were for images. So wen can make an assumption this was built specifically for rendering only images. We can also guess that they may have implemented some form of URL / file validation to prevent file inclusion or rendering dangerous URLs.
    - Google logo: `https://play.esea.net/global/media_preview.php?url=http://www.google.com/images/logo.png`, worked.
    - His own server: `https://play.esea.net/global/media_preview.php?url=http://ziot.org/1.png`, worked.
  - The author guessed it may check file extensions (parse file extension from the URL) and maybe going a bit farther by validating the file type on their server.
    - Some typical tricks about file extension was "null-byte (`%00`)", "additional forward slashes (`/`)" and "question marks (`?`)".
    - Tried `https://play.esea.net/global/media_preview.php?url=http://ziot.org/?.png`, worked.
  - Now there was definitely SSRF, but how limited is it?
    - The first obvious thing was that this was vulnerable to XSS. We could force it to load an html file with a Javascript payload and it would execute within the context of esea's domain.
    - The next thing the author tried was other protocols, but none of them worked (the author showed other protocols he tried, this maybe could use as proc in other scene).
    - The last triky was to query "AWS metadata". By querying `http://169.254.169.254/`, you are able to pull information about the "AWS instances" such as the private address, hostname, public keys, subnet ids, and more. Probably the most shocking data you can pull is IAM role secret keys giving you API access to that AWS account.
- [Plotly AWS EC2 Metadata Disclosure via SSRF and a Stored XSS via Presentation Link)](https://ysx.me.uk/a-pair-of-plotly-bugs-stored-xss-and-aws-metadata-ssrf/) by Yasin Soliman
  - SSRF disclosed "AWS metadat":
    - `https://plot.ly/external/?url=http://169.254.169.254/latest/meta-data`
    - `https://plot.ly/external/?url=http://169.254.169.254/latest/meta-data/public-hostname`
    - `https://plot.ly/external/?url=http://169.254.169.254/latest/dynamic/instance-identity/document`
- [Piercing the Veil: Server Side Request Forgery to NIPRNet access](https://medium.com/bugbountywriteup/piercing-the-veil-server-side-request-forgery-to-niprnet-access-c358fd5e249a) by Alyssa Herrera
  - During the author's reconnaissance of military websites as part of the Department of Defense's vulnerability disclousure, he noticed two particular websites were using "Jira", a popular issue tracking web application. Later, he noticed a tweet discussing SSRF being actively exploited in "Jira". After reading about this, he immediately revisited the two "Jira" instances.
  - Tried `https://website.mil/plugins/servlet/oauth/users/icon-uri?consumerUri=http://google.com`, worked.
  - "AWS metadata":
    - local host name: `http://169.254.169.254/latest/meta-data/local-hostname/`, worked.
    - credential for their AWS instance: `http://169.254.169.254/latest/meta-data/iam/security-credential`, didn't worked.
    - other sensitive data (private IP, accout ID, server information, etc): `http://169.254.169.254/latest/dynamic/instance-identity/document`, worked.
  - The author immediately stopped all testing and sent a report. The company initially marked the report as medium severity vulnerability, but he felt that this was critical issue given what he could do so far. With permission in hand, he got to work on pivoting and exploiting the endpoint to it's fullest extent.
  - Scanned the local host port to see if there's any protocols he could invoke.
    - 21(FTP) / 22(SSH) / 80(Web) / 443(SSL Web) / 8080(Proxy)
    - What made testing this endpoint quite easy was the fact he could see various errors occurring that can help him probe their server and network.
  - I don't understand the rest part of this writeup.
- [How i converted SSRF TO XSS in jira](https://medium.com/@D0rkerDevil/how-i-convert-ssrf-to-xss-in-a-ssrf-vulnerable-jira-e9f37ad5b158) by Ashish Kunwar
  - The author was very much into Bug Bounty and he spent his whole day doing this finding new and interesting stuff and kept on upgrading his recon techniques.
  - The author chosed a random site and got a lot of subdomains. He specifically looked for any "Jira" environment and found one.
  - He followed the previous writeup to manage to get any sensitive info, but he could only do `plugins/servlet/oauth/users/icon-uri?consumerUri=https://google.com`.
  - The author then replaced `https://google.com` with `http://brutelogic.com.br/poc.svg` and got XSS.
    - `http://brutelogic.com.br/poc.svg` could be used as a XSS proc in some similar scene.
- [How I found XSS via SSRF vulnerability](https://medium.com/@adeshkolte/how-i-found-xss-via-ssrf-vulnerability-adesh-kolte-873b30a6b89f) by Adesh Kolte
  - After reading the previous two writeups, the author used "Google dork" to find some outdated "Jira" instances to practice.
  - Nothing new here.
- [GETTING READ ACCESS ON EDMODO PRODUCTION SERVER BY EXPLOITING SSRF](https://www.shawarkhan.com/2018/05/getting-read-access-on-edmodo.html) by SHAWAR KHAN
  - While exploring Edmodo's services and dubdomains, the author came across a subdomain `partnerships.edmodo.com`. This domain had a registration area where publisher could register by submitting a form. Using Burpsuite, the author found that while writing data to the from a POST requst was being sent to the following URL:
    - `https://partnerships.edmodo.com/wp-content/themes/edmodo-developers/form-proxy.php?url=https://www.edmodo.com/index/ajax-check-in-db`
    - Seemed like the `form-proxy.php` was somehow sending data to the file `ajax-check-in-db`.
  - The author tried replacing `url` parameter value to `http://my-ip-address`, worked, he got a GET request to his server.
  - Using `http://127.0.0.1:80`, didn't worked.
  - Tried `http://localhost:22`, negative response, indicated this proc worked.
    - Tried "SMTP service" (`http://localhost:25`), worked, grabbed the SMTP banner.
    - The author was able to do an internal port scan and grabbed banners of ohter services.
  - The author ran another Burpsuite Intruder and detected different schemes being  used, he found `Gopher`. "SMTP" can be exploited if we have "Gropher protocol" enabled.
    - The author showed the proc to exploit "SMTP".
  - There were other schemes available as well such as "ftp" and some other. Used "file" scheme to read files on their server:
    - Tried `file:///etc/hosts`, worked.
    - Tried `file:///etc/passwd`, didn't work, there might be some kind of firewall.
    - Tried `file:///etc/./passwd`, worked.

### File Inclusion

#### Local File Inclusion (LFI)

- [CVV #1: Local File Inclusion](https://medium.com/bugbountywriteup/cvv-1-local-file-inclusion-ebc48e0e479a) by SI9INT
  - This writeup showed some useful methods when expanding a "LFI" to a "RCE".
    - Path Truncation / Nullbyte Injection / (/proc/self) / PHP wrapper / Log poisoning / PHP Sessions / phpinfo() / E-Mail
- [LFI to Command Execution: Deutche Telekom Bug Bounty](https://medium.com/@maxon3/lfi-to-command-execution-deutche-telekom-bug-bounty-6fe0de7df7a6) by Daniel Maksimovic
  - The author did subdomain bruteforce on telekom.de to see if there were new subdomains. After running `aquatone`, `dnsenum`, `recon-ng` and `sublist3r`, he collected all of the subdomains and removed duplicates, created a simple bash script to iterate over them and run `dirb` on every subdomain.
  - The author saw one subdomain had `info.php` page available (he just loves "php", developer usually mess up something, and leave some doors for hackers to come in). After opening page he was greeted with login page.
  - It was time to fire up BurpSuite and do some spidering. Few seconds later nice URL showed in burp: `https://netweb.telekom.de/netweb/gui/help.php?HELPFILE=logon.hlp`. The author replaced `logon.hlp` with `../../../../../../../../etc/passwd`, LFI.
  - There is a list of files you could use as the proc of LFI.
  - Time to execute some command. The author choose `error.log` poisoning option. The previous `info.php` showed the location of `error.log` file, and made his job a lot easier, all the locations from "SecList LFI list" gave 0 hits on the `error.log` file location.
    - `https://netweb.telekom.de/netweb/gui/help.php?HELPFILE=../../../../../../../../../../../../../pkg/moip/netinfo/logs/apache-netweb-P/error.log`
  - While running `dirb` on host the author found file `soap.php`, that showed some errors that ended inside `error.log`, and one of the data inside log was "referer value".
    - A simple test (the proc is worth to study) to see if "referer value" is executed.
- ["Journey from LFI to RCE"-How I was able to get the same in one of the India’s popular property buy/sell company](https://medium.com/bugbountywriteup/bugbounty-journey-from-lfi-to-rce-how-a69afe5a0899) by Avinash Jain
  - The author found LFI in the target site: `https://www.victimsite.com/forum/attachment-serve?name=../../../../../../../../../../etc/shadow&path=`. (How did the author find this LFI?)
  - Escalate LFI to get RCE: get access to some file may be "log files" which could provide some user controller input (in order to run some command).
  - The author tried reading "access logs", "error logs", different location to access them. But it seems the user with which he got LFI didn't have access to these logs.
  - Did more researching, the author came to know that `/proc/self/fd` provides symbolic shortcut to "access logs" and various other system related file. So he ran intruder over `/proc/self/fd/{number}` and one of the fd files provided him access to "access logs".
  - The "referer header" in the "access log" caught the author's attention because he knew that it was something which is under user controlled input. Time to execute some command. He added "referer header" in the HTTP request and set its value tp "system(id)".
  - The proc in this writeup is worth to study.
- [LFI to RCE via access_log injection](https://medium.com/@p4c3n0g3/lfi-to-rce-via-access-log-injection-88684351e7c0) by NoGe
  - A trick from "Loacal File Inclusion" / "File Path Traversal" to "Remote Code Execution" by injecting the "access_log".
  - `http://proqualitycontrol.com/index.php?page=aboutus` is vulnerable to LFR / FPT. Payload: `../../../../../../../../../../../../../../../etc/passwd%00`
  - Changed with `/etc/httpd/conf/httpd.conf` (not all `httpd.conf` is here, to find the "access_log" location you need to find `httpd.conf` first).
  - Opened the file called "access_log", in this case `/home/pro_99/proqualitycontrol.com/access_log`.
  - There is a perl script to inject the "access_log". The author also showed how to check if we've successfully injected the "access_log".
  - Then time to execute command on server: `/home/pro_99/proqualitycontrol.com/access_log%00&cmd=id`.
  - The author didn't say what server (server type can be found in the response header).
- [API keys leakage, Source code disclosure in India’s largest e-commerce health care company](https://medium.com/bugbountywriteup/bugbounty-api-keys-leakage-source-code-disclosure-in-indias-largest-e-commerce-health-care-c75967392c7e) by Avinash Jain
  - The author found a request URL containing `filename=AML129.jpgi` and in the response header the "Server" was "Microsoft-IIS/8.5". So LFI.
  - There is a list of files you could use as the proc of LFI.
  - By this vulnerability, the author was able to read source code of the application, sensitive files like webconfig where he got APIs key of mail server, sms, payment gateway etc, and further he was able to use these mail server key to send mail from their enterprise mail server and were even able to send sms using the sms keys to their customers.
- [GETTING PHP CODE EXECUTION AND LEVERAGE ACCESS TO PANELS,DATABASES,SERVER](https://www.shawarkhan.com/2018/06/getting-php-code-execution-and-leverage.html) by SHAWAR KHAN
  - At first, the author enumerated all the public subdomains of target application but there wasn't much subdomains found and most of them were static. So he moved to "host discovery phase" using "Shodan" and "Censys".
  - A quick search by domain name on "Censys" and found subdomain `server1.redacted.com` which returned "403 Forbidden" when visited over http. By simply applying "google dorks" and searching on some engines, the author found that this subdomain was not indexed and nothing returned any kind of contents that he could make use of. Then he did "dirsearch" and found that the server blocked the IP after every 10 requests (he could add some delays and use some proxies to bypass this IP based protection but that won't do the trick as he had to do an intense enumeration over that target, so that won't be the trick).
  - So as everything had failed, the only way left was to check for their snapshots and sitemap that was cached by "wayback (archive.org)" web archive. This trick worked every time for the author and mostly got backups and stuff on servers when there is a deadend like this one.
    - The author used "wayback" web archive to get a list URL of the target applcition, this method is worth to study.
  - When accessed `files.php` it returned some PHP error a "error_reporting" was turned on.
  - "undefined index" means it was using a specifc index which was not passed which in this case was the url parameter. So the author added url parameter indicatd by "undefined index" with random value.
  - The exploitation inspired by the error message need some knowladge of PHP. I don't understand the rest part of this writeup.

#### Remode File Incusion (RFI)

### Simple Remote Code Execution (Simple RCE)

- [Command Injection in Google Console](http://www.pranav-venkat.com/2016/03/command-injection-which-got-me-6000.html) by Venkat S
  - Actually, this was a "client side command injection" about "Google Cloud Shell".
  - `https://console.cloud.google.com/home/dashboard?project="name of the project"`:
    - Tested for IDOR: `https://console.cloud.google.com/home/dashboard?project="Random project name"`, not vulnerable to IDOR, but reflected the name of project in "Cloud Shell"
    - Tested for XSS: `https://console.cloud.google.com/home/dashboard?project="XSS vector"`, not vulnerable to XSS, but on activating "Cloud Shell" there was some syntax error.
    - `https://console.cloud.google.com/home/dashboard?project=;`, there was no syntax error, and "Cloud Shell" created successfully.
    - In Linux, we can chain commands in various ways, the one way is by using semi-colon operator. e.g. `apt-get update; apt-get upgrade`
    - So, `https://console.cloud.google.com/home/dashboard?project=;ping google.com` and `https://console.cloud.google.com/home/dashboard?project=;cat /etc/passwd`, both worked well.
    - At this point, te author could inject commands which affects his own vm but not Google servers.
  - Crashed victim's vm: `https://console.cloud.google.com/home/dashboard?project=;sudo cp /dev/zero /dev/mem`, once victim access this URL and click "Activate cloud shell", his / her vm crashes.
  - Deleted victim's files: `https://console.cloud.google.com/home/dashboard?project=;sudo rm -rf /`, this will delete victims root directory which also deletes appengine files.
  - This vulnerability existed in bash script created in client side (javascript), it affected:
    - `https://console.cloud.google.com`
    - `https://console.developer.google.com`
- [Secure your Jenkins instance or hackers will force you to](http://nahamsec.com/secure-your-jenkins-instance-or-hackers-will-force-you-to/) by Ben Sadeghipour
  - The author showed how he preformed his recon by looking at Slack and Snapchat's bug bounty programs.
  - How to find some interesting subdomains on `censys.io` that wouldn't have been able to find by brute forcing.
  - `REDACTED-jenkins-Environment.sc-corp.net` pointed the user to login in order to see what's on that site. At this point, the author wondered if there's a prod environment, there's got to be more. Then the author used script that would look for different permutations of `REDACTED-jenkins-$env.sc-corp.net` with the following list: `dev, alpha, stage, prod, beta, local, test`. As expected a few of those returned with 302 as their response code, which hinted that they maybe behind a login.
  - The author went to the `prod` instance and tried to login, however that didn't work. So he moved down the list and tried the same method on the other instances. Luckily, one of the instances allowed him to login to the Jenkins instance using a gmail account. Once logged in, the author could access the "Script Console".
  - At this point, the author ran a script that allowed him to read a file on the server and immediately stopped further testing and reported it to the Snapchat team.
  - Some examples for exploiting "Jenkins":
    - Usually having access to builds on Jenkins could possibly give you access to credentials, api_keys / secrets, and obviously the source code.
    - Jenkins allows you to setup different plugins such as "Github OAuth" where you are able to allow users to login using your organization which could expose your "Github token", which can be used to access more data using the "Github API".
    - The "Script Console" allows you to read files using one line of code (the author gives a proc), you can also execute a command (the author gives a proc).
  - Takeaways:
    - Jenkins allows you to have different user permissions. That means just because you have authenticated to the Jenkins instance, it doesn't guarantee you with Remote Command Execution.
    - Don't let it scare you away if it requires authentication via Github or Google OAuth.
    - Don't spam programs with "publicly accessible Jenkins" reports unless you can possibly exploit one or more of the above examples.
- [RCE Unsecure Jenkins Instance](https://blog.securitybreached.org/2018/09/07/rce-jenkins-instance-dosomething-org-bug-bounty-poc/) by Muhammad Khizer Javed
  - The author was checking subdomains of a site and found a subdomain `jenkins-thor.dosomething.org`. By name he got that it must be a Jenkins Instance so he open that subdomain and got redirected to Github Login Page.
  - The author logged in Jenkins Instance using his Github account, then he had complete admin access to the Jenkins Instance.
- [From finding Jenkins instance to Command Execution](https://medium.com/@logicbomb_1/bugbounty-from-finding-jenkins-instance-to-command-execution-secure-your-jenkins-instance-9bd1e75c2288) by Avinash Jain
  - The author ususally uses `https://censys.io` to find public server IPs.
  - When the author searched the targeted domain, he found an instance running on 8080 prot, the server name was "Jetty". This gave him a glimpse that it might have Jenkins running on it (usually because it's running on a standard port 80 / 443 / 8080 / 8443 on Jetty).
  - The author further checked the IP (also on `https://censys.io`) for more details and it was indeed Jenkins running there.
  - This Jenkins Instance was publically accessible and it didn't have any authentication. The author could act like an admin.
  - Some dashboards of Jenkins:
    - /asynchPeople/ - it gives access to view all the people having access of Jenkins Instance.
    - /credential/ - it gives access to view credential ids, names.
    - /configure/ - it is a configuration management dashboard for Jenkins.
    - /configureSecurity/ - configuration management for security settings.
    - /script/ - script console to run commands.
- [FROM SHODAN TO REMOTE CODE EXECUTION #1 – HACKING JENKINS](https://the-infosec.com/2017/06/22/from-shodan-to-remote-code-execution-1-hacking-jenkins/) by emenalf
  - How to find "Jenkins Instance" on `shodan.io`.
- [FROM SHODAN TO REMOTE CODE EXECUTION #2 – HACKING OPENDREAMBOX 2.0.0](https://the-infosec.com/2017/05/12/from-shodan-to-rce-opendreambox-2-0-0-code-execution/) by emenalf
  - "Dreambox" is a company which offers Digital TV set top boxes and other related services.
  - How to find "Dreambox" on `shodan.io` and exploit it.

### HTTP Header Injection

### Subdomain Takeover
